(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    102897,       1862]
NotebookOptionsPosition[    101330,       1811]
NotebookOutlinePosition[    101695,       1827]
CellTagsIndexPosition[    101652,       1824]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Firstly, it is necessary to start the subkernels between which ",
 StyleBox["MathLink",
  FontSlant->"Italic"],
 " connections will later be established. Since the environment will no \
longer be stateless after the subkernels are able to communicate with one \
another, we must set the appropriate options so that there will be no attempt \
at recovery in case any subkernel fails."
}], "Text",
 CellChangeTimes->{{3.51801051334375*^9, 3.518010567921875*^9}, {
  3.5180113830625*^9, 3.518011521203125*^9}, {3.5180164330625*^9, 
  3.5180164374375*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetSystemOptions", "[", 
   RowBox[{"\"\<ParallelOptions\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<RecoveryMode\>\"", "\[Rule]", "\"\<Abandon\>\""}], ",", 
      RowBox[{"\"\<RelaunchFailedKernels\>\"", "\[Rule]", "False"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{
    RowBox[{"LaunchKernels", "[", "]"}], ",", 
    RowBox[{"LaunchKernels", "::", "nodef"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4667093283125*^9, 3.466709337453125*^9}, {
   3.466709593859375*^9, 3.46670959459375*^9}, {3.466709640640625*^9, 
   3.46670964890625*^9}, {3.466709739828125*^9, 3.4667097433125*^9}, {
   3.4667101400625*^9, 3.466710144328125*^9}, {3.46671018121875*^9, 
   3.46671018178125*^9}, {3.466710658859375*^9, 3.46671069409375*^9}, {
   3.466710760578125*^9, 3.46671081503125*^9}, {3.46671085875*^9, 
   3.466710865453125*^9}, {3.466711049140625*^9, 3.46671105034375*^9}, {
   3.46671128840625*^9, 3.466711316703125*^9}, {3.466711761296875*^9, 
   3.46671176265625*^9}, {3.4667118*^9, 3.466711800828125*^9}, 
   3.466712008234375*^9, {3.466787567921875*^9, 3.466787570375*^9}, {
   3.466787833734375*^9, 3.46678786753125*^9}, {3.466787927078125*^9, 
   3.466788014*^9}, {3.46678805*^9, 3.466788118046875*^9}, {
   3.46678836571875*^9, 3.466788492265625*^9}, 3.466788529671875*^9, {
   3.466789423546875*^9, 3.4667894249375*^9}, {3.466789489578125*^9, 
   3.4667894900625*^9}, {3.466792428140625*^9, 3.466792430296875*^9}, {
   3.46679259115625*^9, 3.466792592109375*^9}, {3.466792712640625*^9, 
   3.466792797890625*^9}, 3.4667928686875*^9, {3.46679381103125*^9, 
   3.4667938346875*^9}, {3.46679397703125*^9, 3.466794068359375*^9}, {
   3.466794298234375*^9, 3.466794318765625*^9}, {3.466794745375*^9, 
   3.466794813265625*^9}, {3.46679491784375*^9, 3.466794928484375*^9}, {
   3.46679500053125*^9, 3.46679501378125*^9}, {3.4667950785*^9, 
   3.4667951105625*^9}, {3.46679520125*^9, 3.466795202328125*^9}, {
   3.46679537584375*^9, 3.46679540821875*^9}, {3.4667954411875*^9, 
   3.466795520734375*^9}, {3.466795677078125*^9, 3.4667956856875*^9}, {
   3.4667957633125*^9, 3.4667957705625*^9}, {3.4667959534375*^9, 
   3.466795955078125*^9}, {3.466796414578125*^9, 3.466796414703125*^9}, {
   3.4667964815*^9, 3.466796502546875*^9}, {3.466796918609375*^9, 
   3.466796937421875*^9}, {3.46679697115625*^9, 3.466797011375*^9}, {
   3.4667970475*^9, 3.466797063421875*^9}, {3.466797196328125*^9, 
   3.46679722640625*^9}, {3.46679737678125*^9, 3.466797393078125*^9}, {
   3.466797559734375*^9, 3.46679757978125*^9}, {3.4667980139375*^9, 
   3.466798019171875*^9}, {3.46679817871875*^9, 3.466798196*^9}, {
   3.466798235625*^9, 3.4667983150625*^9}, {3.466798390953125*^9, 
   3.466798414640625*^9}, {3.46679851503125*^9, 3.466798520984375*^9}, {
   3.46679912709375*^9, 3.466799169265625*^9}, {3.466799294265625*^9, 
   3.46679929946875*^9}, {3.466799381328125*^9, 3.466799382234375*^9}, {
   3.46680069971875*^9, 3.46680071034375*^9}, {3.4668008208125*^9, 
   3.466800821359375*^9}, {3.466800951453125*^9, 3.466801045078125*^9}, {
   3.466801233875*^9, 3.4668012361875*^9}, {3.466801302609375*^9, 
   3.466801303953125*^9}, {3.466803092078125*^9, 3.46680309296875*^9}, {
   3.46680313684375*^9, 3.466803263140625*^9}, {3.4668033511875*^9, 
   3.46680335709375*^9}, {3.466804238671875*^9, 3.4668042509375*^9}, {
   3.46680431859375*^9, 3.466804389734375*^9}, {3.4670512375625*^9, 
   3.46705128384375*^9}, {3.467051331625*^9, 3.467051416484375*^9}, {
   3.46705148496875*^9, 3.4670514856875*^9}, 3.467051524171875*^9, {
   3.46705161296875*^9, 3.467051658875*^9}, {3.46705794303125*^9, 
   3.467057993453125*^9}, {3.467233426046875*^9, 3.4672334444375*^9}, {
   3.467235718171875*^9, 3.46723572309375*^9}, {3.467236316546875*^9, 
   3.4672363183125*^9}, {3.4672363571875*^9, 3.4672363598125*^9}, {
   3.467566663875*^9, 3.467566732578125*^9}, {3.467567573984375*^9, 
   3.467567596109375*^9}, {3.46756763696875*^9, 3.467567662234375*^9}, {
   3.467567816875*^9, 3.467567828640625*^9}, {3.467568764484375*^9, 
   3.4675687749375*^9}, {3.46756981090625*^9, 3.46756981503125*^9}, {
   3.467577279734375*^9, 3.467577286515625*^9}, {3.467577379703125*^9, 
   3.467577382140625*^9}, {3.467577551046875*^9, 3.46757755684375*^9}, {
   3.467577587046875*^9, 3.467577616671875*^9}, {3.467580309890625*^9, 
   3.467580385375*^9}, {3.467580417796875*^9, 3.467580419359375*^9}, {
   3.467581070625*^9, 3.46758107696875*^9}, {3.46758113909375*^9, 
   3.46758114709375*^9}, {3.467581219015625*^9, 3.4675812224375*^9}, {
   3.4675812758125*^9, 3.46758130590625*^9}, {3.467581616625*^9, 
   3.467581620484375*^9}, {3.467582175125*^9, 3.4675821843125*^9}, {
   3.4675834463125*^9, 3.467583504453125*^9}, {3.4685051195*^9, 
   3.4685053505625*^9}, {3.468505383125*^9, 3.468505383203125*^9}, {
   3.468505417875*^9, 3.468505419796875*^9}, {3.46850546790625*^9, 
   3.468505469421875*^9}, {3.468505619109375*^9, 3.46850564015625*^9}, {
   3.468505682609375*^9, 3.46850574303125*^9}, {3.468505785453125*^9, 
   3.468505794234375*^9}, {3.46850607603125*^9, 3.46850608559375*^9}, {
   3.468506123171875*^9, 3.468506138390625*^9}, {3.4685061764375*^9, 
   3.468506177140625*^9}, {3.468507229703125*^9, 3.4685072319375*^9}, {
   3.4685073046875*^9, 3.46850736203125*^9}, {3.46850740653125*^9, 
   3.468507414625*^9}, {3.468507474375*^9, 3.46850751378125*^9}, {
   3.46850807625*^9, 3.468508110421875*^9}, {3.4685081945625*^9, 
   3.468508200375*^9}, {3.468512292*^9, 3.468512348703125*^9}, {
   3.4685126366875*^9, 3.46851264021875*^9}, {3.46851274446875*^9, 
   3.468512759*^9}, {3.46851297246875*^9, 3.468512995203125*^9}, {
   3.46852101546875*^9, 3.468521019609375*^9}, 3.468521085703125*^9, {
   3.46910220084375*^9, 3.469102273921875*^9}, {3.469102378171875*^9, 
   3.469102380265625*^9}, {3.469102516890625*^9, 3.4691025184375*^9}, {
   3.469102556109375*^9, 3.46910256390625*^9}, {3.469290356609375*^9, 
   3.46929037015625*^9}, {3.4719026935625*^9, 3.471902718703125*^9}, {
   3.4719027543125*^9, 3.471902802859375*^9}, {3.471902838828125*^9, 
   3.471902894015625*^9}, {3.47190301990625*^9, 3.4719030214375*^9}, {
   3.47190307971875*^9, 3.471903081375*^9}, {3.47190313015625*^9, 
   3.471903182609375*^9}, {3.4719032200625*^9, 3.4719032446875*^9}, {
   3.471903304453125*^9, 3.4719033069375*^9}, {3.4719040261875*^9, 
   3.471904029078125*^9}, {3.471992852703125*^9, 3.4719928980625*^9}, {
   3.471992950125*^9, 3.471992958578125*^9}, {3.47199300296875*^9, 
   3.4719930055*^9}, {3.471993036921875*^9, 3.471993083640625*^9}, {
   3.4719939763125*^9, 3.471994150734375*^9}, {3.471994236640625*^9, 
   3.471994287515625*^9}, {3.4719943634375*^9, 3.4719943706875*^9}, {
   3.471994428375*^9, 3.47199443790625*^9}, {3.47199468096875*^9, 
   3.471994703296875*^9}, {3.4719947413125*^9, 3.471994742078125*^9}, {
   3.47199483403125*^9, 3.471994863296875*^9}, {3.471995335453125*^9, 
   3.471995335875*^9}, {3.471995878984375*^9, 3.47199589271875*^9}, {
   3.47199601640625*^9, 3.47199612634375*^9}, {3.4719961845*^9, 
   3.47199630421875*^9}, {3.47199633621875*^9, 3.47199636190625*^9}, 
   3.47199668303125*^9, {3.472050238671875*^9, 3.472050270484375*^9}, {
   3.472053770359375*^9, 3.472053795875*^9}, {3.4720538305*^9, 
   3.472053835390625*^9}, {3.47205414140625*^9, 3.4720541989375*^9}, {
   3.472054404375*^9, 3.472054405171875*^9}, {3.47206320075*^9, 
   3.472063213765625*^9}, {3.47206325415625*^9, 3.47206327790625*^9}, {
   3.472063321609375*^9, 3.4720633253125*^9}, {3.472063618609375*^9, 
   3.472063656125*^9}, {3.4720636978125*^9, 3.47206375209375*^9}, {
   3.472064800796875*^9, 3.472064804078125*^9}, {3.472067836359375*^9, 
   3.4720678379375*^9}, {3.472071841265625*^9, 3.472071885515625*^9}, {
   3.47207197184375*^9, 3.472071999125*^9}, {3.4720720363125*^9, 
   3.472072049765625*^9}, {3.47207208640625*^9, 3.47207214528125*^9}, {
   3.472072182203125*^9, 3.47207218421875*^9}, {3.472072216265625*^9, 
   3.472072221671875*^9}, {3.472072255296875*^9, 3.4720722673125*^9}, {
   3.472072331234375*^9, 3.472072348890625*^9}, {3.472072434234375*^9, 
   3.472072502015625*^9}, {3.4720725989375*^9, 3.4720726104375*^9}, {
   3.472072669*^9, 3.47207269971875*^9}, {3.472073280078125*^9, 
   3.47207333915625*^9}, {3.47207339684375*^9, 3.4720734595625*^9}, {
   3.472073491125*^9, 3.472073501109375*^9}, {3.4720736113125*^9, 
   3.472073671078125*^9}, {3.47207406834375*^9, 3.472074072328125*^9}, {
   3.472074187875*^9, 3.472074306515625*^9}, {3.472074352421875*^9, 
   3.472074388390625*^9}, {3.472074435953125*^9, 3.472074459625*^9}, {
   3.4720744911875*^9, 3.472074584375*^9}, {3.47207464715625*^9, 
   3.47207467253125*^9}, {3.4720747159375*^9, 3.472074722796875*^9}, {
   3.47207481553125*^9, 3.47207484821875*^9}, {3.47207610634375*^9, 
   3.472076128359375*^9}, {3.472076169359375*^9, 3.472076176078125*^9}, {
   3.4720762064375*^9, 3.47207621509375*^9}, {3.47207626603125*^9, 
   3.472076270921875*^9}, {3.472076350015625*^9, 3.47207635040625*^9}, 
   3.47207676659375*^9, {3.472076831796875*^9, 3.4720769445*^9}, {
   3.47207924575*^9, 3.472079269421875*^9}, {3.472079495046875*^9, 
   3.472079525234375*^9}, {3.47207970690625*^9, 3.4720797088125*^9}, {
   3.472079916890625*^9, 3.4720799296875*^9}, {3.472079980828125*^9, 
   3.4720799954375*^9}, 3.472080050765625*^9, {3.472506454390625*^9, 
   3.472506484640625*^9}, {3.477499755890625*^9, 3.477499763046875*^9}, 
   3.4774997938125*^9, {3.51801109003125*^9, 3.518011101578125*^9}}],

Cell[TextData[{
 "Internally, the ",
 StyleBox["Parallel`", "Input"],
 " package is based on anonymous kernel objects signifying locations to which \
expressions may be submitted in a queue for evaluation. The ",
 StyleBox["$KernelID", "Input"],
 "s correspond to these abstract objects and may be duplicated or reassigned \
arbitrarily; they are consequently unsuitable to our present purpose, \
necessitating the use of ",
 StyleBox["$RankID", "Input"],
 " instead."
}], "Text",
 CellChangeTimes->{{3.47208036696875*^9, 3.47208040184375*^9}, {
   3.472080437203125*^9, 3.472080469984375*^9}, {3.47208051646875*^9, 
   3.47208060428125*^9}, {3.47208065109375*^9, 3.47208069421875*^9}, {
   3.472081028546875*^9, 3.47208106615625*^9}, {3.472081119484375*^9, 
   3.472081140734375*^9}, {3.47208212296875*^9, 3.472082148*^9}, {
   3.472082182125*^9, 3.47208220278125*^9}, {3.47208229428125*^9, 
   3.472082302453125*^9}, {3.4720826483125*^9, 3.472082659859375*^9}, {
   3.47208269640625*^9, 3.47208269925*^9}, {3.472082809296875*^9, 
   3.472082825765625*^9}, {3.472082892203125*^9, 3.47208291890625*^9}, {
   3.472082967203125*^9, 3.472082969375*^9}, {3.472083354921875*^9, 
   3.472083421890625*^9}, {3.472083461625*^9, 3.472083485765625*^9}, {
   3.4720836083125*^9, 3.47208363271875*^9}, {3.472083692015625*^9, 
   3.47208369653125*^9}, {3.4720837678125*^9, 3.472083793484375*^9}, {
   3.47208383225*^9, 3.472083914625*^9}, {3.472083955171875*^9, 
   3.47208401246875*^9}, {3.472084136578125*^9, 3.472084245359375*^9}, {
   3.4721509208125*^9, 3.47215097765625*^9}, 3.47215774265625*^9, {
   3.47215782959375*^9, 3.472157831328125*^9}, {3.472157968546875*^9, 
   3.472157971*^9}, {3.47216344690625*^9, 3.47216347071875*^9}, {
   3.4721635155625*^9, 3.472163671328125*^9}, {3.47216370671875*^9, 
   3.472163707296875*^9}, {3.47216373965625*^9, 3.4721637604375*^9}, {
   3.472163797453125*^9, 3.472163819984375*^9}, {3.472163938046875*^9, 
   3.47216393871875*^9}, {3.472164079140625*^9, 3.472164113078125*^9}, {
   3.47216414575*^9, 3.47216416109375*^9}, {3.47216424390625*^9, 
   3.472164337203125*^9}, {3.47216438621875*^9, 3.4721643935*^9}, {
   3.472164457578125*^9, 3.472164537046875*^9}, {3.472164640359375*^9, 
   3.472164659765625*^9}, {3.472164774671875*^9, 3.47216479771875*^9}, {
   3.47216483865625*^9, 3.4721648595*^9}, {3.4721648944375*^9, 
   3.472164895890625*^9}, {3.472164927328125*^9, 3.472164968109375*^9}, {
   3.47216506946875*^9, 3.4721650700625*^9}, {3.47216519115625*^9, 
   3.47216519821875*^9}, {3.47216531971875*^9, 3.472165323921875*^9}, {
   3.472165360203125*^9, 3.472165403484375*^9}, {3.472165459578125*^9, 
   3.472165501640625*^9}, {3.472165613765625*^9, 3.47216562559375*^9}, 
   3.472165679890625*^9, {3.472165726015625*^9, 3.4721657263125*^9}, {
   3.472165768671875*^9, 3.472165796359375*^9}, {3.472165861578125*^9, 
   3.47216586840625*^9}, {3.472165923578125*^9, 3.472165924015625*^9}, {
   3.47216605625*^9, 3.47216610534375*^9}, {3.4721661765*^9, 
   3.472166177*^9}, {3.47232719715625*^9, 3.4723272069375*^9}, {
   3.47232730225*^9, 3.472327400546875*^9}, {3.472327430875*^9, 
   3.472327434359375*^9}, {3.47232820690625*^9, 3.47232834725*^9}, {
   3.472329657078125*^9, 3.472329674*^9}, {3.4723352095625*^9, 
   3.4723352106875*^9}, {3.472335250671875*^9, 3.472335289875*^9}, {
   3.47233562453125*^9, 3.472335631609375*^9}, {3.472335684625*^9, 
   3.4723357003125*^9}, {3.472396925*^9, 3.47239694678125*^9}, {
   3.472504919671875*^9, 3.472504950546875*^9}, {3.477489895046875*^9, 
   3.4774899675*^9}, {3.47749003640625*^9, 3.47749008534375*^9}, {
   3.4774901394375*^9, 3.47749018821875*^9}, {3.477490219171875*^9, 
   3.477490262796875*^9}, {3.477490314765625*^9, 3.477490365734375*^9}, {
   3.477490412515625*^9, 3.477490413109375*^9}, {3.477490451984375*^9, 
   3.477490767984375*^9}, {3.477490807765625*^9, 3.477490855265625*^9}, {
   3.4774908859375*^9, 3.477491025265625*^9}, {3.477491085625*^9, 
   3.4774911078125*^9}, {3.477491140984375*^9, 3.477491144859375*^9}, {
   3.47749197178125*^9, 3.477491978375*^9}, {3.477492018921875*^9, 
   3.477492061453125*^9}, {3.477492111375*^9, 3.47749225146875*^9}, {
   3.47749231015625*^9, 3.47749244353125*^9}, {3.4774925383125*^9, 
   3.4774926485*^9}, {3.47749316675*^9, 3.477493301828125*^9}, {
   3.4774933756875*^9, 3.477493377921875*^9}, {3.477493420671875*^9, 
   3.477493470578125*^9}, 3.47749379259375*^9, {3.517839611359375*^9, 
   3.517839617578125*^9}, {3.518011619171875*^9, 3.518011674359375*^9}, {
   3.518016452796875*^9, 3.518016464890625*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ranks", "=", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "[", "\[IndentingNewLine]", 
      RowBox[{"kernels", "=", 
       RowBox[{"Kernels", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rankAssignments", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Unevaluated", "[", 
         RowBox[{"$RankID", "=", "#"}], "]"}], "&"}], "/@", "ranks"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Parallel`Developer`ParallelDispatch", "[", 
     RowBox[{"rankAssignments", ",", "kernels"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4667093283125*^9, 3.466709337453125*^9}, {
   3.466709593859375*^9, 3.46670959459375*^9}, {3.466709640640625*^9, 
   3.46670964890625*^9}, {3.466709739828125*^9, 3.4667097433125*^9}, {
   3.4667101400625*^9, 3.466710144328125*^9}, {3.46671018121875*^9, 
   3.46671018178125*^9}, {3.466710658859375*^9, 3.46671069409375*^9}, {
   3.466710760578125*^9, 3.46671081503125*^9}, {3.46671085875*^9, 
   3.466710865453125*^9}, {3.466711049140625*^9, 3.46671105034375*^9}, {
   3.46671128840625*^9, 3.466711316703125*^9}, {3.466711761296875*^9, 
   3.46671176265625*^9}, {3.4667118*^9, 3.466711800828125*^9}, 
   3.466712008234375*^9, {3.466787567921875*^9, 3.466787570375*^9}, {
   3.466787833734375*^9, 3.46678786753125*^9}, {3.466787927078125*^9, 
   3.466788014*^9}, {3.46678805*^9, 3.466788118046875*^9}, {
   3.46678836571875*^9, 3.466788492265625*^9}, 3.466788529671875*^9, {
   3.466789423546875*^9, 3.4667894249375*^9}, {3.466789489578125*^9, 
   3.4667894900625*^9}, {3.466792428140625*^9, 3.466792430296875*^9}, {
   3.46679259115625*^9, 3.466792592109375*^9}, {3.466792712640625*^9, 
   3.466792797890625*^9}, 3.4667928686875*^9, {3.46679381103125*^9, 
   3.4667938346875*^9}, {3.46679397703125*^9, 3.466794068359375*^9}, {
   3.466794298234375*^9, 3.466794318765625*^9}, {3.466794745375*^9, 
   3.466794813265625*^9}, {3.46679491784375*^9, 3.466794928484375*^9}, {
   3.46679500053125*^9, 3.46679501378125*^9}, {3.4667950785*^9, 
   3.4667951105625*^9}, {3.46679520125*^9, 3.466795202328125*^9}, {
   3.46679537584375*^9, 3.46679540821875*^9}, {3.4667954411875*^9, 
   3.466795520734375*^9}, {3.466795677078125*^9, 3.4667956856875*^9}, {
   3.4667957633125*^9, 3.4667957705625*^9}, {3.4667959534375*^9, 
   3.466795955078125*^9}, {3.466796414578125*^9, 3.466796414703125*^9}, {
   3.4667964815*^9, 3.466796502546875*^9}, {3.466796918609375*^9, 
   3.466796937421875*^9}, {3.46679697115625*^9, 3.466797011375*^9}, {
   3.4667970475*^9, 3.466797063421875*^9}, {3.466797196328125*^9, 
   3.46679722640625*^9}, {3.46679737678125*^9, 3.466797393078125*^9}, {
   3.466797559734375*^9, 3.46679757978125*^9}, {3.4667980139375*^9, 
   3.466798019171875*^9}, {3.46679817871875*^9, 3.466798196*^9}, {
   3.466798235625*^9, 3.4667983150625*^9}, {3.466798390953125*^9, 
   3.466798414640625*^9}, {3.46679851503125*^9, 3.466798520984375*^9}, {
   3.46679912709375*^9, 3.466799169265625*^9}, {3.466799294265625*^9, 
   3.46679929946875*^9}, {3.466799381328125*^9, 3.466799382234375*^9}, {
   3.46680069971875*^9, 3.46680071034375*^9}, {3.4668008208125*^9, 
   3.466800821359375*^9}, {3.466800951453125*^9, 3.466801045078125*^9}, {
   3.466801233875*^9, 3.4668012361875*^9}, {3.466801302609375*^9, 
   3.466801303953125*^9}, {3.466803092078125*^9, 3.46680309296875*^9}, {
   3.46680313684375*^9, 3.466803263140625*^9}, {3.4668033511875*^9, 
   3.46680335709375*^9}, {3.466804238671875*^9, 3.4668042509375*^9}, {
   3.46680431859375*^9, 3.466804389734375*^9}, {3.4670512375625*^9, 
   3.46705128384375*^9}, {3.467051331625*^9, 3.467051416484375*^9}, {
   3.46705148496875*^9, 3.4670514856875*^9}, 3.467051524171875*^9, {
   3.46705161296875*^9, 3.467051658875*^9}, {3.46705794303125*^9, 
   3.467057993453125*^9}, {3.467233426046875*^9, 3.4672334444375*^9}, {
   3.467235718171875*^9, 3.46723572309375*^9}, {3.467236316546875*^9, 
   3.4672363183125*^9}, {3.4672363571875*^9, 3.4672363598125*^9}, {
   3.467566663875*^9, 3.467566732578125*^9}, {3.467567573984375*^9, 
   3.467567596109375*^9}, {3.46756763696875*^9, 3.467567662234375*^9}, {
   3.467567816875*^9, 3.467567828640625*^9}, {3.467568764484375*^9, 
   3.4675687749375*^9}, {3.46756981090625*^9, 3.46756981503125*^9}, {
   3.467577279734375*^9, 3.467577286515625*^9}, {3.467577379703125*^9, 
   3.467577382140625*^9}, {3.467577551046875*^9, 3.46757755684375*^9}, {
   3.467577587046875*^9, 3.467577616671875*^9}, {3.467580309890625*^9, 
   3.467580385375*^9}, {3.467580417796875*^9, 3.467580419359375*^9}, {
   3.467581070625*^9, 3.46758107696875*^9}, {3.46758113909375*^9, 
   3.46758114709375*^9}, {3.467581219015625*^9, 3.4675812224375*^9}, {
   3.4675812758125*^9, 3.46758130590625*^9}, {3.467581616625*^9, 
   3.467581620484375*^9}, {3.467582175125*^9, 3.4675821843125*^9}, {
   3.4675834463125*^9, 3.467583504453125*^9}, {3.4685051195*^9, 
   3.4685053505625*^9}, {3.468505383125*^9, 3.468505383203125*^9}, {
   3.468505417875*^9, 3.468505419796875*^9}, {3.46850546790625*^9, 
   3.468505469421875*^9}, {3.468505619109375*^9, 3.46850564015625*^9}, {
   3.468505682609375*^9, 3.46850574303125*^9}, {3.468505785453125*^9, 
   3.468505794234375*^9}, {3.46850607603125*^9, 3.46850608559375*^9}, {
   3.468506123171875*^9, 3.468506138390625*^9}, {3.4685061764375*^9, 
   3.468506177140625*^9}, {3.468507229703125*^9, 3.4685072319375*^9}, {
   3.4685073046875*^9, 3.46850736203125*^9}, {3.46850740653125*^9, 
   3.468507414625*^9}, {3.468507474375*^9, 3.46850751378125*^9}, {
   3.46850807625*^9, 3.468508110421875*^9}, {3.4685081945625*^9, 
   3.468508200375*^9}, {3.468512292*^9, 3.468512348703125*^9}, {
   3.4685126366875*^9, 3.46851264021875*^9}, {3.46851274446875*^9, 
   3.468512759*^9}, {3.46851297246875*^9, 3.468512995203125*^9}, {
   3.46852101546875*^9, 3.468521019609375*^9}, 3.468521085703125*^9, {
   3.46910220084375*^9, 3.469102273921875*^9}, {3.469102378171875*^9, 
   3.469102380265625*^9}, {3.469102516890625*^9, 3.4691025184375*^9}, {
   3.469102556109375*^9, 3.46910256390625*^9}, {3.469290356609375*^9, 
   3.46929037015625*^9}, {3.4719026935625*^9, 3.471902718703125*^9}, {
   3.4719027543125*^9, 3.471902802859375*^9}, {3.471902838828125*^9, 
   3.471902894015625*^9}, {3.47190301990625*^9, 3.4719030214375*^9}, {
   3.47190307971875*^9, 3.471903081375*^9}, {3.47190313015625*^9, 
   3.471903182609375*^9}, {3.4719032200625*^9, 3.4719032446875*^9}, {
   3.471903304453125*^9, 3.4719033069375*^9}, {3.4719040261875*^9, 
   3.471904029078125*^9}, {3.471992852703125*^9, 3.4719928980625*^9}, {
   3.471992950125*^9, 3.471992958578125*^9}, {3.47199300296875*^9, 
   3.4719930055*^9}, {3.471993036921875*^9, 3.471993083640625*^9}, {
   3.4719939763125*^9, 3.471994150734375*^9}, {3.471994236640625*^9, 
   3.471994287515625*^9}, {3.4719943634375*^9, 3.4719943706875*^9}, {
   3.471994428375*^9, 3.47199443790625*^9}, {3.47199468096875*^9, 
   3.471994703296875*^9}, {3.4719947413125*^9, 3.471994742078125*^9}, {
   3.47199483403125*^9, 3.471994863296875*^9}, {3.471995335453125*^9, 
   3.471995335875*^9}, {3.471995878984375*^9, 3.47199589271875*^9}, {
   3.47199601640625*^9, 3.47199612634375*^9}, {3.4719961845*^9, 
   3.47199630421875*^9}, {3.47199633621875*^9, 3.47199636190625*^9}, 
   3.47199668303125*^9, {3.472050238671875*^9, 3.472050270484375*^9}, {
   3.472053770359375*^9, 3.472053795875*^9}, {3.4720538305*^9, 
   3.472053835390625*^9}, {3.47205414140625*^9, 3.4720541989375*^9}, {
   3.472054404375*^9, 3.472054405171875*^9}, {3.47206320075*^9, 
   3.472063213765625*^9}, {3.47206325415625*^9, 3.47206327790625*^9}, {
   3.472063321609375*^9, 3.4720633253125*^9}, {3.472063618609375*^9, 
   3.472063656125*^9}, {3.4720636978125*^9, 3.47206375209375*^9}, {
   3.472064800796875*^9, 3.472064804078125*^9}, {3.472067836359375*^9, 
   3.4720678379375*^9}, {3.472071841265625*^9, 3.472071885515625*^9}, {
   3.47207197184375*^9, 3.472071999125*^9}, {3.4720720363125*^9, 
   3.472072049765625*^9}, {3.47207208640625*^9, 3.47207214528125*^9}, {
   3.472072182203125*^9, 3.47207218421875*^9}, {3.472072216265625*^9, 
   3.472072221671875*^9}, {3.472072255296875*^9, 3.4720722673125*^9}, {
   3.472072331234375*^9, 3.472072348890625*^9}, {3.472072434234375*^9, 
   3.472072502015625*^9}, {3.4720725989375*^9, 3.4720726104375*^9}, {
   3.472072669*^9, 3.47207269971875*^9}, {3.472073280078125*^9, 
   3.47207333915625*^9}, {3.47207339684375*^9, 3.4720734595625*^9}, {
   3.472073491125*^9, 3.472073501109375*^9}, {3.4720736113125*^9, 
   3.472073671078125*^9}, {3.47207406834375*^9, 3.472074072328125*^9}, {
   3.472074187875*^9, 3.472074306515625*^9}, {3.472074352421875*^9, 
   3.472074388390625*^9}, {3.472074435953125*^9, 3.472074459625*^9}, {
   3.4720744911875*^9, 3.472074584375*^9}, {3.47207464715625*^9, 
   3.47207467253125*^9}, {3.4720747159375*^9, 3.472074722796875*^9}, {
   3.47207481553125*^9, 3.47207484821875*^9}, {3.47207610634375*^9, 
   3.472076128359375*^9}, {3.472076169359375*^9, 3.472076176078125*^9}, {
   3.4720762064375*^9, 3.47207621509375*^9}, {3.47207626603125*^9, 
   3.472076270921875*^9}, {3.472076350015625*^9, 3.47207635040625*^9}, 
   3.47207676659375*^9, {3.472076831796875*^9, 3.4720769445*^9}, {
   3.47207924575*^9, 3.472079269421875*^9}, {3.472079495046875*^9, 
   3.472079525234375*^9}, {3.47207970690625*^9, 3.4720797088125*^9}, {
   3.472079916890625*^9, 3.4720799296875*^9}, {3.472079980828125*^9, 
   3.4720799954375*^9}, {3.472080050765625*^9, 3.4720800745*^9}, {
   3.472082422703125*^9, 3.4720824285*^9}, 3.472082543109375*^9, {
   3.47208435221875*^9, 3.472084352671875*^9}, {3.472084742125*^9, 
   3.472084764515625*^9}, {3.4720859984375*^9, 3.4720859991875*^9}, {
   3.47215541709375*^9, 3.4721554890625*^9}, {3.47215554171875*^9, 
   3.472155660328125*^9}, {3.472156219828125*^9, 3.472156259390625*^9}, {
   3.472157091828125*^9, 3.47215710953125*^9}, {3.47216703746875*^9, 
   3.472167054203125*^9}, {3.47228614084375*^9, 3.472286174203125*^9}, {
   3.472286229359375*^9, 3.47228623025*^9}, {3.47240667296875*^9, 
   3.472406676125*^9}, {3.477490389484375*^9, 3.47749039234375*^9}, {
   3.51760412471875*^9, 3.517604141625*^9}, {3.5176042080625*^9, 
   3.517604294359375*^9}, {3.5178398999375*^9, 3.5178399083125*^9}, {
   3.517841181109375*^9, 3.51784119790625*^9}}],

Cell[TextData[{
 "We define the ",
 StyleBox["Rank", "Input"],
 " object, which will store (as ",
 StyleBox["DownValues", "Input"],
 ") the properties of each of the ranks and implement (through ",
 StyleBox["UpValues", "Input"],
 ") the context-sensitive substitution of these properties into various \
expressions for which they are required. Note that ",
 StyleBox["KernelObject", "Input"],
 "s and ",
 StyleBox["Parallel`", "Input"],
 " evaluation functions are not ordinarily propagated to the subkernels since \
they refer to and operate on the subkernels\[CloseCurlyQuote] ",
 StyleBox["$ParentLink", "Input"],
 ". Therefore we define the following relations only in the master kernel."
}], "Text",
 CellChangeTimes->{{3.472336528796875*^9, 3.472336546390625*^9}, {
   3.472336649203125*^9, 3.47233668615625*^9}, {3.472336728453125*^9, 
   3.472336767890625*^9}, {3.472399177921875*^9, 3.47239918178125*^9}, {
   3.472405527703125*^9, 3.472405528359375*^9}, {3.477493529328125*^9, 
   3.477493533234375*^9}, 3.51783969684375*^9, {3.51783975184375*^9, 
   3.517839759859375*^9}, {3.517839794234375*^9, 3.51783987334375*^9}, 
   3.517841227390625*^9, {3.518016410140625*^9, 3.518016415046875*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Rank", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"Rank", ",", "NHoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rank", "[", 
    RowBox[{
     RowBox[{"ranks_List", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}], ",", 
     "\"\<KernelObject\>\""}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rank", "[", 
      RowBox[{"#", ",", "\"\<KernelObject\>\""}], "]"}], "&"}], "/@", 
    "ranks"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{"Set", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rank", "[", 
       RowBox[{"ranks", ",", "\"\<KernelObject\>\""}], "]"}], ",", 
      "kernels"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rank", "[", 
     RowBox[{"_", ",", "\"\<KernelObject\>\""}], "]"}], "=", "$Failed"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rank", "/:", 
   RowBox[{"ParallelEvaluate", "[", 
    RowBox[{"cmd_", ",", 
     RowBox[{"Rank", "[", 
      RowBox[{"ranks", ":", 
       RowBox[{"_Integer", "|", 
        RowBox[{"_List", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}]}]}], 
      "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"ParallelEvaluate", "[", 
    RowBox[{"cmd", ",", 
     RowBox[{"Rank", "[", 
      RowBox[{"ranks", ",", "\"\<KernelObject\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rank", "/:", 
   RowBox[{
    RowBox[{"Parallel`Developer`ParallelDispatch", "[", "\[IndentingNewLine]", 
     RowBox[{"cmds_", ",", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks", ":", 
        RowBox[{"_Integer", "|", 
         RowBox[{"_List", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"VectorQ", "[", 
             RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}]}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{
     RowBox[{"Length", "[", "cmds", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", "ranks", "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Parallel`Developer`ParallelDispatch", "[", 
    RowBox[{"cmds", ",", 
     RowBox[{"Rank", "[", 
      RowBox[{"ranks", ",", "\"\<KernelObject\>\""}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4667093283125*^9, 3.466709337453125*^9}, {
   3.466709593859375*^9, 3.46670959459375*^9}, {3.466709640640625*^9, 
   3.46670964890625*^9}, {3.466709739828125*^9, 3.4667097433125*^9}, {
   3.4667101400625*^9, 3.466710144328125*^9}, {3.46671018121875*^9, 
   3.46671018178125*^9}, {3.466710658859375*^9, 3.46671069409375*^9}, {
   3.466710760578125*^9, 3.46671081503125*^9}, {3.46671085875*^9, 
   3.466710865453125*^9}, {3.466711049140625*^9, 3.46671105034375*^9}, {
   3.46671128840625*^9, 3.466711316703125*^9}, {3.466711761296875*^9, 
   3.46671176265625*^9}, {3.4667118*^9, 3.466711800828125*^9}, 
   3.466712008234375*^9, {3.466787567921875*^9, 3.466787570375*^9}, {
   3.466787833734375*^9, 3.46678786753125*^9}, {3.466787927078125*^9, 
   3.466788014*^9}, {3.46678805*^9, 3.466788118046875*^9}, {
   3.46678836571875*^9, 3.466788492265625*^9}, 3.466788529671875*^9, {
   3.466789423546875*^9, 3.4667894249375*^9}, {3.466789489578125*^9, 
   3.4667894900625*^9}, {3.466792428140625*^9, 3.466792430296875*^9}, {
   3.46679259115625*^9, 3.466792592109375*^9}, {3.466792712640625*^9, 
   3.466792797890625*^9}, 3.4667928686875*^9, {3.46679381103125*^9, 
   3.4667938346875*^9}, {3.46679397703125*^9, 3.466794068359375*^9}, {
   3.466794298234375*^9, 3.466794318765625*^9}, {3.466794745375*^9, 
   3.466794813265625*^9}, {3.46679491784375*^9, 3.466794928484375*^9}, {
   3.46679500053125*^9, 3.46679501378125*^9}, {3.4667950785*^9, 
   3.4667951105625*^9}, {3.46679520125*^9, 3.466795202328125*^9}, {
   3.46679537584375*^9, 3.46679540821875*^9}, {3.4667954411875*^9, 
   3.466795520734375*^9}, {3.466795677078125*^9, 3.4667956856875*^9}, {
   3.4667957633125*^9, 3.4667957705625*^9}, {3.4667959534375*^9, 
   3.466795955078125*^9}, {3.466796414578125*^9, 3.466796414703125*^9}, {
   3.4667964815*^9, 3.466796502546875*^9}, {3.466796918609375*^9, 
   3.466796937421875*^9}, {3.46679697115625*^9, 3.466797011375*^9}, {
   3.4667970475*^9, 3.466797063421875*^9}, {3.466797196328125*^9, 
   3.46679722640625*^9}, {3.46679737678125*^9, 3.466797393078125*^9}, {
   3.466797559734375*^9, 3.46679757978125*^9}, {3.4667980139375*^9, 
   3.466798019171875*^9}, {3.46679817871875*^9, 3.466798196*^9}, {
   3.466798235625*^9, 3.4667983150625*^9}, {3.466798390953125*^9, 
   3.466798414640625*^9}, {3.46679851503125*^9, 3.466798520984375*^9}, {
   3.46679912709375*^9, 3.466799169265625*^9}, {3.466799294265625*^9, 
   3.46679929946875*^9}, {3.466799381328125*^9, 3.466799382234375*^9}, {
   3.46680069971875*^9, 3.46680071034375*^9}, {3.4668008208125*^9, 
   3.466800821359375*^9}, {3.466800951453125*^9, 3.466801045078125*^9}, {
   3.466801233875*^9, 3.4668012361875*^9}, {3.466801302609375*^9, 
   3.466801303953125*^9}, {3.466803092078125*^9, 3.46680309296875*^9}, {
   3.46680313684375*^9, 3.466803263140625*^9}, {3.4668033511875*^9, 
   3.46680335709375*^9}, {3.466804238671875*^9, 3.4668042509375*^9}, {
   3.46680431859375*^9, 3.466804389734375*^9}, {3.4670512375625*^9, 
   3.46705128384375*^9}, {3.467051331625*^9, 3.467051416484375*^9}, {
   3.46705148496875*^9, 3.4670514856875*^9}, 3.467051524171875*^9, {
   3.46705161296875*^9, 3.467051658875*^9}, {3.46705794303125*^9, 
   3.467057993453125*^9}, {3.467233426046875*^9, 3.4672334444375*^9}, {
   3.467235718171875*^9, 3.46723572309375*^9}, {3.467236316546875*^9, 
   3.4672363183125*^9}, {3.4672363571875*^9, 3.4672363598125*^9}, {
   3.467566663875*^9, 3.467566732578125*^9}, {3.467567573984375*^9, 
   3.467567596109375*^9}, {3.46756763696875*^9, 3.467567662234375*^9}, {
   3.467567816875*^9, 3.467567828640625*^9}, {3.467568764484375*^9, 
   3.4675687749375*^9}, {3.46756981090625*^9, 3.46756981503125*^9}, {
   3.467577279734375*^9, 3.467577286515625*^9}, {3.467577379703125*^9, 
   3.467577382140625*^9}, {3.467577551046875*^9, 3.46757755684375*^9}, {
   3.467577587046875*^9, 3.467577616671875*^9}, {3.467580309890625*^9, 
   3.467580385375*^9}, {3.467580417796875*^9, 3.467580419359375*^9}, {
   3.467581070625*^9, 3.46758107696875*^9}, {3.46758113909375*^9, 
   3.46758114709375*^9}, {3.467581219015625*^9, 3.4675812224375*^9}, {
   3.4675812758125*^9, 3.46758130590625*^9}, {3.467581616625*^9, 
   3.467581620484375*^9}, {3.467582175125*^9, 3.4675821843125*^9}, {
   3.4675834463125*^9, 3.467583504453125*^9}, {3.4685051195*^9, 
   3.4685053505625*^9}, {3.468505383125*^9, 3.468505383203125*^9}, {
   3.468505417875*^9, 3.468505419796875*^9}, {3.46850546790625*^9, 
   3.468505469421875*^9}, {3.468505619109375*^9, 3.46850564015625*^9}, {
   3.468505682609375*^9, 3.46850574303125*^9}, {3.468505785453125*^9, 
   3.468505794234375*^9}, {3.46850607603125*^9, 3.46850608559375*^9}, {
   3.468506123171875*^9, 3.468506138390625*^9}, {3.4685061764375*^9, 
   3.468506177140625*^9}, {3.468507229703125*^9, 3.4685072319375*^9}, {
   3.4685073046875*^9, 3.46850736203125*^9}, {3.46850740653125*^9, 
   3.468507414625*^9}, {3.468507474375*^9, 3.46850751378125*^9}, {
   3.46850807625*^9, 3.468508110421875*^9}, {3.4685081945625*^9, 
   3.468508200375*^9}, {3.468512292*^9, 3.468512348703125*^9}, {
   3.4685126366875*^9, 3.46851264021875*^9}, {3.46851274446875*^9, 
   3.468512759*^9}, {3.46851297246875*^9, 3.468512995203125*^9}, {
   3.46852101546875*^9, 3.468521019609375*^9}, 3.468521085703125*^9, {
   3.46910220084375*^9, 3.469102273921875*^9}, {3.469102378171875*^9, 
   3.469102380265625*^9}, {3.469102516890625*^9, 3.4691025184375*^9}, {
   3.469102556109375*^9, 3.46910256390625*^9}, {3.469290356609375*^9, 
   3.46929037015625*^9}, {3.4719026935625*^9, 3.471902718703125*^9}, {
   3.4719027543125*^9, 3.471902802859375*^9}, {3.471902838828125*^9, 
   3.471902894015625*^9}, {3.47190301990625*^9, 3.4719030214375*^9}, {
   3.47190307971875*^9, 3.471903081375*^9}, {3.47190313015625*^9, 
   3.471903182609375*^9}, {3.4719032200625*^9, 3.4719032446875*^9}, {
   3.471903304453125*^9, 3.4719033069375*^9}, {3.4719040261875*^9, 
   3.471904029078125*^9}, {3.471992852703125*^9, 3.4719928980625*^9}, {
   3.471992950125*^9, 3.471992958578125*^9}, {3.47199300296875*^9, 
   3.4719930055*^9}, {3.471993036921875*^9, 3.471993083640625*^9}, {
   3.4719939763125*^9, 3.471994150734375*^9}, {3.471994236640625*^9, 
   3.471994287515625*^9}, {3.4719943634375*^9, 3.4719943706875*^9}, {
   3.471994428375*^9, 3.47199443790625*^9}, {3.47199468096875*^9, 
   3.471994703296875*^9}, {3.4719947413125*^9, 3.471994742078125*^9}, {
   3.47199483403125*^9, 3.471994863296875*^9}, {3.471995335453125*^9, 
   3.471995335875*^9}, {3.471995878984375*^9, 3.47199589271875*^9}, {
   3.47199601640625*^9, 3.47199612634375*^9}, {3.4719961845*^9, 
   3.47199630421875*^9}, {3.47199633621875*^9, 3.47199636190625*^9}, 
   3.47199668303125*^9, {3.472050238671875*^9, 3.472050270484375*^9}, {
   3.472053770359375*^9, 3.472053795875*^9}, {3.4720538305*^9, 
   3.472053835390625*^9}, {3.47205414140625*^9, 3.4720541989375*^9}, {
   3.472054404375*^9, 3.472054405171875*^9}, {3.47206320075*^9, 
   3.472063213765625*^9}, {3.47206325415625*^9, 3.47206327790625*^9}, {
   3.472063321609375*^9, 3.4720633253125*^9}, {3.472063618609375*^9, 
   3.472063656125*^9}, {3.4720636978125*^9, 3.47206375209375*^9}, {
   3.472064800796875*^9, 3.472064804078125*^9}, {3.472067836359375*^9, 
   3.4720678379375*^9}, {3.472071841265625*^9, 3.472071885515625*^9}, {
   3.47207197184375*^9, 3.472071999125*^9}, {3.4720720363125*^9, 
   3.472072049765625*^9}, {3.47207208640625*^9, 3.47207214528125*^9}, {
   3.472072182203125*^9, 3.47207218421875*^9}, {3.472072216265625*^9, 
   3.472072221671875*^9}, {3.472072255296875*^9, 3.4720722673125*^9}, {
   3.472072331234375*^9, 3.472072348890625*^9}, {3.472072434234375*^9, 
   3.472072502015625*^9}, {3.4720725989375*^9, 3.4720726104375*^9}, {
   3.472072669*^9, 3.47207269971875*^9}, {3.472073280078125*^9, 
   3.47207333915625*^9}, {3.47207339684375*^9, 3.4720734595625*^9}, {
   3.472073491125*^9, 3.472073501109375*^9}, {3.4720736113125*^9, 
   3.472073671078125*^9}, {3.47207406834375*^9, 3.472074072328125*^9}, {
   3.472074187875*^9, 3.472074306515625*^9}, {3.472074352421875*^9, 
   3.472074388390625*^9}, {3.472074435953125*^9, 3.472074459625*^9}, {
   3.4720744911875*^9, 3.472074584375*^9}, {3.47207464715625*^9, 
   3.47207467253125*^9}, {3.4720747159375*^9, 3.472074722796875*^9}, {
   3.47207481553125*^9, 3.47207484821875*^9}, {3.47207610634375*^9, 
   3.472076128359375*^9}, {3.472076169359375*^9, 3.472076176078125*^9}, {
   3.4720762064375*^9, 3.47207621509375*^9}, {3.47207626603125*^9, 
   3.472076270921875*^9}, {3.472076350015625*^9, 3.47207635040625*^9}, 
   3.47207676659375*^9, {3.472076831796875*^9, 3.4720769445*^9}, {
   3.47207924575*^9, 3.472079269421875*^9}, {3.472079495046875*^9, 
   3.472079525234375*^9}, {3.47207970690625*^9, 3.4720797088125*^9}, {
   3.472079916890625*^9, 3.4720799296875*^9}, {3.472079980828125*^9, 
   3.4720799954375*^9}, {3.472080050765625*^9, 3.472080068515625*^9}, {
   3.47208454940625*^9, 3.47208456484375*^9}, {3.472138838828125*^9, 
   3.47213887546875*^9}, {3.4721391785625*^9, 3.472139222390625*^9}, {
   3.4721392776875*^9, 3.47213932965625*^9}, {3.472139454515625*^9, 
   3.472139486828125*^9}, {3.47213969021875*^9, 3.472139771859375*^9}, {
   3.47213986284375*^9, 3.472139882359375*^9}, {3.472139935234375*^9, 
   3.472139991*^9}, {3.472140305546875*^9, 3.472140307625*^9}, {
   3.472140935140625*^9, 3.472140949015625*^9}, {3.472141071109375*^9, 
   3.47214115784375*^9}, {3.472141239953125*^9, 3.472141262375*^9}, {
   3.47214632415625*^9, 3.472146330375*^9}, {3.472146368953125*^9, 
   3.472146389109375*^9}, {3.472146441125*^9, 3.4721464919375*^9}, {
   3.472157469640625*^9, 3.4721574725625*^9}, {3.472157504984375*^9, 
   3.4721575460625*^9}, {3.472157582265625*^9, 3.472157584125*^9}, 
   3.472327483109375*^9, {3.472327527171875*^9, 3.472327532515625*^9}, {
   3.472327579625*^9, 3.472327652125*^9}, {3.4723276858125*^9, 
   3.472327688171875*^9}, {3.4723278206875*^9, 3.472327839359375*^9}, {
   3.472327894203125*^9, 3.472327961984375*^9}, {3.472328007875*^9, 
   3.472328064796875*^9}, {3.4723280973125*^9, 3.472328113859375*^9}, 
   3.472336523015625*^9, {3.4723367901875*^9, 3.47233679221875*^9}, 
   3.472336837046875*^9, {3.472402789671875*^9, 3.472402805296875*^9}, {
   3.47458054653125*^9, 3.474580564578125*^9}, {3.477499171359375*^9, 
   3.477499177015625*^9}, {3.477499212875*^9, 3.477499255453125*^9}, {
   3.477499462921875*^9, 3.47749946703125*^9}, 3.477602311515625*^9, {
   3.51328836234375*^9, 3.513288379171875*^9}, {3.517839893484375*^9, 
   3.5178400258125*^9}, {3.517841649328125*^9, 3.51784166153125*^9}, {
   3.5418188445*^9, 3.54181885565625*^9}}],

Cell[TextData[{
 "Having created a mapping between subkernels and ranks, we are now in a \
position to open ",
 StyleBox["MathLink",
  FontSlant->"Italic"],
 " connections between them. For each pair of ranks we require that one \
endpoint creates a link to which its partner subsequently connects. A \
convenient way to divide this work that does not depend on the number of \
ranks is to partition the matrix of connections into upper and lower \
triangular portions. Here we form the lower triangle and hence determine by \
which ranks the links are to be created."
}], "Text",
 CellChangeTimes->{{3.4720848284375*^9, 3.47208483696875*^9}, {
   3.47208499046875*^9, 3.47208499696875*^9}, {3.472085037640625*^9, 
   3.472085051046875*^9}, {3.472085194375*^9, 3.472085357546875*^9}, {
   3.47208539065625*^9, 3.472085391859375*^9}, {3.4720854445*^9, 
   3.472085469703125*^9}, {3.47214921490625*^9, 3.472149311734375*^9}, {
   3.472155208140625*^9, 3.47215528353125*^9}, 3.4721579008125*^9, {
   3.472166107609375*^9, 3.472166111921875*^9}, {3.47216629425*^9, 
   3.472166379234375*^9}, {3.472166494859375*^9, 3.472166576015625*^9}, {
   3.472166674359375*^9, 3.47216668846875*^9}, {3.4721667861875*^9, 
   3.472166790640625*^9}, {3.472166822953125*^9, 3.472166886359375*^9}, {
   3.472167081234375*^9, 3.47216708403125*^9}, {3.47216717625*^9, 
   3.47216723790625*^9}, {3.472329747515625*^9, 3.472329747953125*^9}, {
   3.472335755765625*^9, 3.472335756671875*^9}, 3.4723365074375*^9, 
   3.47233655746875*^9, {3.47233689503125*^9, 3.4723369116875*^9}, {
   3.472398766109375*^9, 3.472398814171875*^9}, {3.472398848375*^9, 
   3.47239893609375*^9}, {3.472398983578125*^9, 3.472399042828125*^9}, {
   3.47239908375*^9, 3.4723990985*^9}, 3.472399160625*^9, 3.472405526*^9, {
   3.47240560790625*^9, 3.472405714765625*^9}, {3.4724058379375*^9, 
   3.472405842890625*^9}, {3.472410745109375*^9, 3.472410746046875*^9}, 
   3.47241181590625*^9, {3.472413292171875*^9, 3.47241329475*^9}, {
   3.518009843046875*^9, 3.5180098695625*^9}, {3.518009900234375*^9, 
   3.518009921296875*^9}, {3.51800995846875*^9, 3.51800998315625*^9}, {
   3.5180165111875*^9, 3.518016511578125*^9}, {3.518016545125*^9, 
   3.51801655815625*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allRanks", "=", 
       RowBox[{"$AllRanks", "=", "ranks"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rankCount", "=", 
       RowBox[{"$RankCount", "=", 
        RowBox[{"Length", "[", "ranks", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"machineRules", "=", 
       RowBox[{"ParallelEvaluate", "[", 
        RowBox[{"$RankID", "\[Rule]", "$MachineID"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$AllRanks", "=", "allRanks"}], ";", "\[IndentingNewLine]", 
      RowBox[{"$RankCount", "=", "rankCount"}], ";", "\[IndentingNewLine]", 
      RowBox[{"locallyLinkedRanks", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"$AllRanks", ",", 
         RowBox[{"$RankID", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"localLinks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#1", "===", "#2"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Same", " ", "$MachineID", " ", "on", " ", "both", " ", "link", 
             " ", 
             RowBox[{"endpoints", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"LinkCreate", "[", 
            RowBox[{"LinkProtocol", "\[Rule]", "\"\<SharedMemory\>\""}], 
            "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Optimization", " ", "for", " ", "intra"}], "-", 
             RowBox[{"machine", " ", 
              RowBox[{"links", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"LinkCreate", "[", 
            RowBox[{"LinkProtocol", "\[Rule]", "\"\<TCPIP\>\""}], "]"}]}], 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Inter", "-", 
             RowBox[{"machine", " ", "link"}]}], ";", " ", 
            RowBox[{"must", " ", "use", " ", 
             RowBox[{"TCP", "/", 
              RowBox[{"IP", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$RankID", ",", "locallyLinkedRanks"}], "}"}], "/.", 
          "machineRules"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "also", " ", "create", " ", "a", " ", "loopback", " ", 
        RowBox[{"link", ".", " ", "Although"}], " ", "this", " ", "is", " ", 
        "technically", " ", "unnecessary", " ", "it", " ", "may", " ", 
        "prove", " ", "useful", " ", "for", " ", "testing", " ", "or", " ", 
        "help", " ", "to", " ", "simplify", " ", "the", " ", "construction", 
        " ", "of", " ", "various", " ", "collective", " ", "communication", 
        " ", 
        RowBox[{"algorithms", ".", " ", "Loopback"}], " ", "links", " ", "do",
         " ", "not", " ", "have", " ", "any", " ", 
        RowBox[{"LinkProtocol", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ownLink", "=", 
       RowBox[{"LinkCreate", "[", 
        RowBox[{"LinkMode", "\[Rule]", "Loopback"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46705078396875*^9, 3.467050904765625*^9}, {
   3.467050941609375*^9, 3.46705098490625*^9}, {3.467051052953125*^9, 
   3.467051112515625*^9}, {3.467051143390625*^9, 3.467051174546875*^9}, {
   3.46705159628125*^9, 3.467051596609375*^9}, {3.46705171546875*^9, 
   3.467051979484375*^9}, {3.467052726859375*^9, 3.467052742953125*^9}, {
   3.46705298053125*^9, 3.467052984015625*^9}, {3.467053055*^9, 
   3.467053098953125*^9}, {3.467053136140625*^9, 3.46705317325*^9}, {
   3.467053270265625*^9, 3.467053274015625*^9}, 3.467053398765625*^9, {
   3.46705386815625*^9, 3.467053900625*^9}, {3.467053933546875*^9, 
   3.467053964921875*^9}, {3.4670541420625*^9, 3.4670541766875*^9}, 
   3.467054239890625*^9, 3.467054280265625*^9, {3.467054508515625*^9, 
   3.46705452978125*^9}, {3.46705461075*^9, 3.467054668984375*^9}, 
   3.467054706109375*^9, {3.4670550769375*^9, 3.46705507728125*^9}, {
   3.467055305234375*^9, 3.467055342234375*^9}, {3.467056644234375*^9, 
   3.46705671071875*^9}, {3.467056891328125*^9, 3.46705690109375*^9}, {
   3.467057358375*^9, 3.467057376515625*^9}, {3.467057408171875*^9, 
   3.467057552296875*^9}, {3.46705758246875*^9, 3.467057594609375*^9}, {
   3.467057628796875*^9, 3.46705765896875*^9}, {3.467057718828125*^9, 
   3.467057781546875*^9}, {3.467057834046875*^9, 3.467057902890625*^9}, {
   3.46705810659375*^9, 3.467058141125*^9}, {3.467058172390625*^9, 
   3.467058183875*^9}, {3.467058270421875*^9, 3.4670583854375*^9}, 
   3.467058449671875*^9, {3.467231074859375*^9, 3.4672311418125*^9}, {
   3.467231207265625*^9, 3.467231211109375*^9}, {3.4672318519375*^9, 
   3.467231854921875*^9}, {3.467231905640625*^9, 3.46723190725*^9}, {
   3.467232006875*^9, 3.467232015765625*^9}, {3.467232205171875*^9, 
   3.467232232515625*^9}, {3.46723324025*^9, 3.467233269*^9}, {3.467233523*^9,
    3.467233523609375*^9}, {3.4672336678125*^9, 3.46723366971875*^9}, {
   3.4672337058125*^9, 3.467233723*^9}, {3.467233808640625*^9, 
   3.467233838015625*^9}, {3.467234342171875*^9, 3.467234342609375*^9}, {
   3.467235904296875*^9, 3.46723591309375*^9}, {3.46723599309375*^9, 
   3.467236002859375*^9}, {3.467236187109375*^9, 3.467236206703125*^9}, 
   3.46723691440625*^9, {3.467237839328125*^9, 3.467237925296875*^9}, {
   3.46723802415625*^9, 3.467238027171875*^9}, {3.467238088046875*^9, 
   3.467238107421875*^9}, {3.467238166890625*^9, 3.4672382210625*^9}, {
   3.467238301140625*^9, 3.467238303171875*^9}, {3.46723848090625*^9, 
   3.46723848653125*^9}, {3.46723876915625*^9, 3.467238781671875*^9}, 
   3.4672389635*^9, {3.46723900553125*^9, 3.467239027046875*^9}, {
   3.467315484536999*^9, 3.467315485115124*^9}, {3.467317285802624*^9, 
   3.467317313052624*^9}, {3.467317465161999*^9, 3.467317518771374*^9}, {
   3.467321259193249*^9, 3.467321278099499*^9}, {3.467322259833874*^9, 
   3.467322285568249*^9}, {3.4673943435625*^9, 3.467394345015625*^9}, {
   3.4675680370625*^9, 3.4675680381875*^9}, {3.467570097046875*^9, 
   3.46757010071875*^9}, {3.467581476921875*^9, 3.46758148146875*^9}, 
   3.467581621671875*^9, {3.468506339375*^9, 3.46850638278125*^9}, {
   3.468506664734375*^9, 3.46850668803125*^9}, {3.471994342234375*^9, 
   3.47199435178125*^9}, {3.47199439940625*^9, 3.4719944010625*^9}, {
   3.4719948244375*^9, 3.47199482475*^9}, {3.472064243375*^9, 
   3.472064248796875*^9}, {3.472064316*^9, 3.472064316703125*^9}, {
   3.4720860045625*^9, 3.472086009765625*^9}, {3.472086055796875*^9, 
   3.472086079046875*^9}, {3.4722460709887133`*^9, 3.4722461015824633`*^9}, {
   3.4722463501293383`*^9, 3.4722463654105883`*^9}, {3.4722464018480883`*^9, 
   3.4722464047074633`*^9}, {3.4722464989418383`*^9, 
   3.4722465243949633`*^9}, {3.4722465838324633`*^9, 
   3.4722466510668383`*^9}, {3.4722467111918383`*^9, 
   3.4722467848324633`*^9}, {3.4722468173168383`*^9, 3.4722468385199633`*^9}, 
   3.4722469479730883`*^9, {3.4722474766293383`*^9, 3.4722474985980883`*^9}, {
   3.4722475420355883`*^9, 3.4722475501918383`*^9}, {3.4722477614262133`*^9, 
   3.4722477807855883`*^9}, 3.47228625709375*^9, 3.47233214078125*^9, {
   3.472403428734375*^9, 3.472403548546875*^9}, {3.472403603734375*^9, 
   3.47240362609375*^9}, {3.4724036745*^9, 3.472403728109375*^9}, {
   3.4724037860625*^9, 3.47240379765625*^9}, 3.472403965359375*^9, {
   3.472406264125*^9, 3.47240629225*^9}, {3.472406500703125*^9, 
   3.472406504015625*^9}, {3.47240887596875*^9, 3.472408913046875*^9}, {
   3.472415116375*^9, 3.47241513453125*^9}, 3.4725054921875*^9, {
   3.47259473725*^9, 3.472594770484375*^9}, 3.47259481965625*^9, {
   3.472595682828125*^9, 3.472595741125*^9}, {3.472595784125*^9, 
   3.472595797609375*^9}, {3.47259584325*^9, 3.472595920375*^9}, {
   3.4725959745*^9, 3.4725960191875*^9}, {3.47259607309375*^9, 
   3.472596110046875*^9}, {3.47259614415625*^9, 3.472596167578125*^9}, {
   3.47259623634375*^9, 3.472596414625*^9}, {3.472596458203125*^9, 
   3.47259651296875*^9}, {3.4725965670625*^9, 3.472596598875*^9}, 
   3.4725966301875*^9, {3.47259668109375*^9, 3.47259673146875*^9}, {
   3.472596775984375*^9, 3.47259678878125*^9}, {3.472596853640625*^9, 
   3.472596870875*^9}, {3.472596986796875*^9, 3.47259698996875*^9}, {
   3.472597564703125*^9, 3.472597607953125*^9}, {3.472655045265625*^9, 
   3.472655099703125*^9}, {3.472655504765625*^9, 3.472655540078125*^9}, {
   3.47265560015625*^9, 3.47265560709375*^9}, {3.4726557325*^9, 
   3.4726557339375*^9}, {3.472669659828125*^9, 3.472669674265625*^9}, {
   3.47267044978125*^9, 3.472670493921875*^9}, {3.47267361015625*^9, 
   3.472673611703125*^9}, {3.4726905014375*^9, 3.4726905836875*^9}, {
   3.472690756609375*^9, 3.47269076040625*^9}, {3.472690804875*^9, 
   3.47269080509375*^9}, {3.472690846625*^9, 3.47269084725*^9}, {
   3.47269089678125*^9, 3.472690897140625*^9}, {3.477500824609375*^9, 
   3.477500837421875*^9}, {3.51328839296875*^9, 3.5132883955625*^9}, {
   3.517841247546875*^9, 3.51784127728125*^9}, {3.518009956640625*^9, 
   3.518009993046875*^9}, {3.518016693203125*^9, 3.518016734546875*^9}}],

Cell[TextData[{
 "With the necessary links created, all that remains is for the remaining \
rank in each pair to connect to the link hosted by its partner. After the \
links have been opened from both ends, the partners each call ",
 StyleBox["LinkActivate", "Input"],
 " on the connection in order to acknowledge each other."
}], "Text",
 CellChangeTimes->{{3.4720848284375*^9, 3.47208483696875*^9}, {
   3.47208499046875*^9, 3.47208499696875*^9}, {3.472085037640625*^9, 
   3.472085051046875*^9}, {3.472085194375*^9, 3.472085357546875*^9}, {
   3.47208539065625*^9, 3.472085391859375*^9}, {3.4720854445*^9, 
   3.472085469703125*^9}, {3.47214921490625*^9, 3.472149311734375*^9}, {
   3.472155208140625*^9, 3.47215528353125*^9}, 3.4721579008125*^9, {
   3.472166107609375*^9, 3.472166111921875*^9}, {3.47216629425*^9, 
   3.472166379234375*^9}, {3.472166494859375*^9, 3.472166576015625*^9}, {
   3.472166674359375*^9, 3.47216668846875*^9}, {3.4721667861875*^9, 
   3.472166790640625*^9}, {3.472166822953125*^9, 3.472166886359375*^9}, {
   3.472167081234375*^9, 3.47216708403125*^9}, {3.47216717625*^9, 
   3.47216723790625*^9}, {3.472329747515625*^9, 3.472329747953125*^9}, {
   3.472335755765625*^9, 3.472335756671875*^9}, 3.4723365074375*^9, 
   3.47233655746875*^9, {3.47233689503125*^9, 3.4723369116875*^9}, {
   3.472398766109375*^9, 3.472398814171875*^9}, {3.472398848375*^9, 
   3.47239893609375*^9}, {3.472398983578125*^9, 3.472399042828125*^9}, {
   3.47239908375*^9, 3.4723990985*^9}, 3.472399160625*^9, 3.472405526*^9, {
   3.47240560790625*^9, 3.472405714765625*^9}, {3.4724058379375*^9, 
   3.472405842890625*^9}, {3.472410745109375*^9, 3.472410746046875*^9}, 
   3.47241181590625*^9, {3.472413292171875*^9, 3.47241329475*^9}, {
   3.518010141203125*^9, 3.518010462453125*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"linkRules", "=", 
      RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Results", " ", "must", " ", "be", " ", "returned", " ", "in", " ", 
         "rank", " ", "order", " ", "or", " ", "otherwise", " ", "links", " ",
          "will", " ", "be", " ", "established", " ", "between", " ", 
         "incorrectly", " ", "permuted", " ", "pairs", " ", "of", " ", 
         RowBox[{"ranks", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"locallyLinkedRanks", "\[Rule]", "localLinks"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"linkObject", ":", 
           RowBox[{"LinkObject", "[", 
            RowBox[{"linkName_String", ",", "__"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"linkName", ",", 
            RowBox[{
             RowBox[{"LinkProtocol", "\[Rule]", "\"\<LinkProtocol\>\""}], "/.", 
             RowBox[{
             "MathLink`LinkDeviceInformation", "[", "linkObject", "]"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Rank", "[", "$AllRanks", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"remoteLinks", "=", 
       RowBox[{"LinkConnect", "@@@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ReplaceList", "[", 
           RowBox[{"$RankID", ",", "linkRules"}], "]"}], ",", "1"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "LinkActivate", " ", "is", " ", "blocking", " ", "at", " ", "both", 
         " ", "endpoints", " ", "and", " ", "so", " ", "the", " ", "calls", 
         " ", "should", " ", "be", " ", "made", " ", "in", " ", "a", " ", 
         "particular", " ", "order", " ", "so", " ", "as", " ", "to", " ", 
         "avoid", " ", 
         RowBox[{"deadlock", ".", " ", "The"}], " ", "rotation", " ", "is", 
         " ", "not", " ", "required", " ", "for", " ", "correctness", " ", 
         "but", " ", "rather", " ", "overlaps", " ", "pairwise", " ", "calls",
          " ", "that", " ", "have", " ", "no", " ", "serial", " ", 
         "dependence", " ", "for", " ", "better", " ", 
         RowBox[{"performance", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"LinkActivate", ",", 
        RowBox[{"RotateRight", "[", 
         RowBox[{
          RowBox[{"$RankLinks", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"localLinks", ",", "ownLink", ",", "remoteLinks"}], 
             "}"}], "]"}]}], ",", 
          RowBox[{"$RankID", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.467232029984375*^9, 3.46723204465625*^9}, {
   3.46723211290625*^9, 3.467232132015625*^9}, 3.4672322934375*^9, {
   3.46723236653125*^9, 3.46723236784375*^9}, {3.46723241471875*^9, 
   3.46723241978125*^9}, {3.467232461546875*^9, 3.46723248271875*^9}, {
   3.467232525390625*^9, 3.467232525703125*^9}, {3.467232561390625*^9, 
   3.46723256196875*^9}, {3.46723259578125*^9, 3.467232614765625*^9}, 
   3.467232835328125*^9, {3.467232889796875*^9, 3.467232891359375*^9}, {
   3.46723410271875*^9, 3.46723410515625*^9}, 3.467234642109375*^9, {
   3.467234695078125*^9, 3.467234736484375*^9}, {3.467238854046875*^9, 
   3.4672388708125*^9}, {3.467315463990124*^9, 3.467315469286999*^9}, {
   3.467315506536999*^9, 3.467315516786999*^9}, {3.467315977911999*^9, 
   3.467315978771374*^9}, {3.467316090286999*^9, 3.467316107380749*^9}, {
   3.467318350568249*^9, 3.467318351786999*^9}, {3.467318442068249*^9, 
   3.467318471318249*^9}, {3.467319339974499*^9, 3.467319436833874*^9}, {
   3.467319546349499*^9, 3.467319564521374*^9}, {3.467319658677624*^9, 
   3.467319668161999*^9}, {3.467319722786999*^9, 3.467319754865124*^9}, {
   3.467319837208874*^9, 3.467319839380749*^9}, {3.467321245958874*^9, 
   3.467321249193249*^9}, {3.467321289115124*^9, 3.467321305630749*^9}, {
   3.467321410052624*^9, 3.467321412146374*^9}, {3.467352844625*^9, 
   3.4673528726875*^9}, {3.46735331859375*^9, 3.467353373375*^9}, {
   3.467353460734375*^9, 3.467353461015625*^9}, {3.467355027703125*^9, 
   3.4673551335625*^9}, {3.4673551790625*^9, 3.467355222125*^9}, {
   3.4673943603125*^9, 3.46739438665625*^9}, {3.46756624878125*^9, 
   3.467566263890625*^9}, {3.467566361515625*^9, 3.46756639334375*^9}, {
   3.467566455703125*^9, 3.467566483375*^9}, {3.46756657896875*^9, 
   3.46756658675*^9}, {3.4675666249375*^9, 3.46756662815625*^9}, 
   3.467568039046875*^9, {3.467568118328125*^9, 3.4675681405*^9}, {
   3.467568213546875*^9, 3.467568246421875*^9}, {3.46756828603125*^9, 
   3.467568364125*^9}, {3.467568549453125*^9, 3.4675685515625*^9}, {
   3.46756869296875*^9, 3.467568710734375*^9}, {3.46756918778125*^9, 
   3.467569190609375*^9}, {3.467569234859375*^9, 3.4675692365*^9}, {
   3.467569881984375*^9, 3.46756989134375*^9}, 3.46756997984375*^9, {
   3.467570034578125*^9, 3.46757006025*^9}, {3.467570108328125*^9, 
   3.46757011275*^9}, {3.46757015990625*^9, 3.46757016775*^9}, {
   3.46757024890625*^9, 3.46757027515625*^9}, {3.467570740125*^9, 
   3.46757074434375*^9}, {3.4675808411875*^9, 3.467580861640625*^9}, {
   3.467581482796875*^9, 3.4675814838125*^9}, {3.4685045845625*^9, 
   3.468504619046875*^9}, {3.468504827765625*^9, 3.468504860703125*^9}, {
   3.468504958234375*^9, 3.468504961578125*^9}, {3.46850505925*^9, 
   3.468505103921875*^9}, {3.468506515171875*^9, 3.46850660990625*^9}, {
   3.468507033203125*^9, 3.46850707084375*^9}, 3.46850711878125*^9, {
   3.468507671046875*^9, 3.468507735359375*^9}, {3.468507787296875*^9, 
   3.468507810015625*^9}, {3.4685078441875*^9, 3.468507854765625*^9}, {
   3.4685078970625*^9, 3.468507898734375*^9}, {3.4685119034375*^9, 
   3.468511908640625*^9}, {3.468512658359375*^9, 3.4685127040625*^9}, {
   3.4685127363125*^9, 3.46851273821875*^9}, {3.468513030328125*^9, 
   3.46851304484375*^9}, {3.46851333725*^9, 3.4685133665625*^9}, {
   3.46851340859375*^9, 3.468513414703125*^9}, {3.468513533203125*^9, 
   3.468513539171875*^9}, {3.46851359021875*^9, 3.468513592046875*^9}, {
   3.4685202531875*^9, 3.468520255125*^9}, {3.468520297234375*^9, 
   3.468520298375*^9}, {3.4685208625625*^9, 3.468520865546875*^9}, {
   3.468521125234375*^9, 3.468521126234375*^9}, {3.468521586203125*^9, 
   3.468521606609375*^9}, {3.468521957234375*^9, 3.468521999171875*^9}, {
   3.468523000125*^9, 3.468523002875*^9}, {3.468523351296875*^9, 
   3.46852336334375*^9}, 3.468523517828125*^9, {3.468523609734375*^9, 
   3.46852361046875*^9}, {3.46852369959375*^9, 3.46852370778125*^9}, {
   3.46910231034375*^9, 3.469102319109375*^9}, {3.469102465*^9, 
   3.4691024883125*^9}, {3.46910257503125*^9, 3.469102586359375*^9}, 
   3.469102671328125*^9, {3.469290822890625*^9, 3.469290828828125*^9}, {
   3.471903520265625*^9, 3.4719036318125*^9}, {3.471903842875*^9, 
   3.47190387246875*^9}, {3.471994885859375*^9, 3.471994886640625*^9}, {
   3.471994943640625*^9, 3.47199496728125*^9}, {3.47206450034375*^9, 
   3.472064525515625*^9}, {3.47206534140625*^9, 3.472065347109375*^9}, 
   3.472140089875*^9, {3.47214036*^9, 3.47214038284375*^9}, {
   3.472140427109375*^9, 3.472140443109375*^9}, {3.472141270640625*^9, 
   3.472141272109375*^9}, {3.47214130871875*^9, 3.472141342015625*^9}, {
   3.472141435953125*^9, 3.472141449359375*^9}, {3.472146335859375*^9, 
   3.47214633675*^9}, {3.4722461950199633`*^9, 3.4722462355043383`*^9}, {
   3.4722477265355883`*^9, 3.4722477313793383`*^9}, 3.4722479048949633`*^9, {
   3.472287309734375*^9, 3.472287337734375*^9}, {3.472334379671875*^9, 
   3.4723343973125*^9}, 3.47233684878125*^9, {3.472402902515625*^9, 
   3.4724029146875*^9}, {3.472408884765625*^9, 3.472408927125*^9}, {
   3.472408980328125*^9, 3.472408985*^9}, {3.472409216*^9, 
   3.472409219234375*^9}, {3.472413671265625*^9, 3.472413673046875*^9}, {
   3.47241379746875*^9, 3.4724138191875*^9}, {3.472657748609375*^9, 
   3.47265779115625*^9}, {3.4726578284375*^9, 3.4726578529375*^9}, {
   3.47265799940625*^9, 3.472658002296875*^9}, {3.472658235953125*^9, 
   3.47265825234375*^9}, {3.472670976265625*^9, 3.472671106046875*^9}, {
   3.472671155578125*^9, 3.47267116*^9}, {3.472671200796875*^9, 
   3.47267125028125*^9}, {3.472671282671875*^9, 3.47267131375*^9}, {
   3.472671380578125*^9, 3.472671457484375*^9}, {3.472671499015625*^9, 
   3.47267150078125*^9}, {3.472671533078125*^9, 3.47267154371875*^9}, {
   3.47267157540625*^9, 3.472671640109375*^9}, {3.47267168365625*^9, 
   3.4726717011875*^9}, {3.4726717361875*^9, 3.4726717596875*^9}, 
   3.4726726213125*^9, {3.472673071296875*^9, 3.47267307871875*^9}, {
   3.472683465625*^9, 3.472683476578125*^9}, {3.47268353678125*^9, 
   3.47268353971875*^9}, {3.47268424*^9, 3.472684280171875*^9}, 
   3.4726845201875*^9, {3.472684756421875*^9, 3.47268475653125*^9}, {
   3.472684838734375*^9, 3.47268483884375*^9}, {3.47268899596875*^9, 
   3.47268906628125*^9}, {3.47268914425*^9, 3.47268917140625*^9}, 
   3.472689238671875*^9, {3.472689709921875*^9, 3.47268971109375*^9}, {
   3.472690106125*^9, 3.47269011353125*^9}, {3.47269015340625*^9, 
   3.472690168515625*^9}, {3.472690203171875*^9, 3.47269020609375*^9}, {
   3.47283744087869*^9, 3.47283744172244*^9}, {3.474563997*^9, 
   3.474564007515625*^9}, {3.513288413515625*^9, 3.513288414578125*^9}, {
   3.5132885295625*^9, 3.51328853153125*^9}, {3.513289919234375*^9, 
   3.51328992559375*^9}, 3.513290032015625*^9, {3.513290082625*^9, 
   3.513290083015625*^9}, {3.51329016965625*^9, 3.51329023590625*^9}, {
   3.51760444653125*^9, 3.517604456875*^9}, {3.51784130921875*^9, 
   3.517841383578125*^9}, {3.51784179803125*^9, 3.517841811*^9}, 
   3.517842241859375*^9, {3.517842280828125*^9, 3.517842336609375*^9}, {
   3.5178424263125*^9, 3.51784243365625*^9}, {3.51784248521875*^9, 
   3.517842524734375*^9}, {3.51801665778125*^9, 3.518016660640625*^9}, {
   3.541820044015625*^9, 3.541820059875*^9}, {3.541820511421875*^9, 
   3.54182051284375*^9}, 3.541820602234375*^9, {3.54182064946875*^9, 
   3.5418206738125*^9}, {3.54182076575*^9, 3.541820770671875*^9}, {
   3.541820822515625*^9, 3.541820918*^9}, 3.54182127653125*^9, {
   3.54182134415625*^9, 3.541821348171875*^9}, {3.541821382765625*^9, 
   3.54182138475*^9}, {3.541822004859375*^9, 3.54182203240625*^9}, {
   3.541822071015625*^9, 3.5418220809375*^9}, {3.541822359234375*^9, 
   3.54182244009375*^9}, {3.5418226929375*^9, 3.541822709078125*^9}, {
   3.541822757140625*^9, 3.541822770109375*^9}}],

Cell[TextData[{
 "The links having been established, it is now useful to be able to call ",
 StyleBox["MathLink",
  FontSlant->"Italic"],
 " functions with a rank ID rather than a ",
 StyleBox["LinkObject", "Input"],
 ", so here we overload ",
 StyleBox["Rank", "Input"],
 " in order to accomplish this. This time, the definitions are are \
rank-specific, and meaningful only to the subkernels. To demonstrate the \
general principle, we perform a simple all-to-all collective communication."
}], "Text",
 CellChangeTimes->{{3.4720848284375*^9, 3.47208483696875*^9}, {
   3.47208499046875*^9, 3.47208499696875*^9}, {3.472085037640625*^9, 
   3.472085051046875*^9}, {3.472085194375*^9, 3.472085357546875*^9}, {
   3.47208539065625*^9, 3.472085391859375*^9}, {3.4720854445*^9, 
   3.472085469703125*^9}, {3.47214921490625*^9, 3.472149311734375*^9}, {
   3.472155208140625*^9, 3.47215528353125*^9}, 3.4721579008125*^9, {
   3.472166107609375*^9, 3.472166111921875*^9}, {3.47216629425*^9, 
   3.472166379234375*^9}, {3.472166494859375*^9, 3.472166576015625*^9}, {
   3.472166674359375*^9, 3.47216668846875*^9}, {3.4721667861875*^9, 
   3.472166790640625*^9}, {3.472166822953125*^9, 3.472166886359375*^9}, {
   3.472167081234375*^9, 3.47216708403125*^9}, {3.47216717625*^9, 
   3.47216723790625*^9}, {3.472329747515625*^9, 3.472329747953125*^9}, {
   3.472335755765625*^9, 3.472335756671875*^9}, 3.4723365074375*^9, 
   3.47233655746875*^9, {3.47233689503125*^9, 3.4723369116875*^9}, {
   3.472398766109375*^9, 3.472398814171875*^9}, {3.472398848375*^9, 
   3.47239893609375*^9}, {3.472398983578125*^9, 3.472399042828125*^9}, {
   3.47239908375*^9, 3.4723990985*^9}, 3.472399160625*^9, 3.472405526*^9, {
   3.47240560790625*^9, 3.472405714765625*^9}, {3.4724058379375*^9, 
   3.472405842890625*^9}, {3.472410745109375*^9, 3.472410746046875*^9}, 
   3.47241181590625*^9, {3.472413292171875*^9, 3.47241329475*^9}, 
   3.518011242703125*^9, {3.51801127303125*^9, 3.518011356453125*^9}, {
   3.51801178559375*^9, 3.518011937015625*^9}, 3.51801198290625*^9, {
   3.518012013671875*^9, 3.5180120278125*^9}, {3.518012921953125*^9, 
   3.518012926625*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "Rank", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"Rank", ",", "NHoldFirst"}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rank", "[", 
      RowBox[{
       RowBox[{"ranks_List", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}], ",", 
       "\"\<LinkObject\>\""}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Rank", "[", 
        RowBox[{"#", ",", "\"\<LinkObject\>\""}], "]"}], "&"}], "/@", 
      "ranks"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Set", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rank", "[", 
         RowBox[{"$AllRanks", ",", "\"\<LinkObject\>\""}], "]"}], ",", 
        "$RankLinks"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rank", "[", 
      RowBox[{"_", ",", "\"\<LinkObject\>\""}], "]"}], "=", "$Failed"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkWrite", "[", 
      RowBox[{
       RowBox[{"Rank", "[", "rank_Integer", "]"}], ",", "expr_"}], "]"}], ":=", 
     RowBox[{"LinkWrite", "[", 
      RowBox[{
       RowBox[{"Rank", "[", 
        RowBox[{"rank", ",", "\"\<LinkObject\>\""}], "]"}], ",", 
       RowBox[{"Unevaluated", "[", "expr", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkWrite", "[", 
      RowBox[{
       RowBox[{"Rank", "[", 
        RowBox[{"ranks_List", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}], "]"}], ",",
        "expr_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"LinkWrite", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Unevaluated", "[", "expr", "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks", ",", "\"\<LinkObject\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkFlush", "@", 
      RowBox[{"Rank", "[", "rank_Integer", "]"}]}], ":=", 
     RowBox[{"LinkFlush", "@", 
      RowBox[{"Rank", "[", 
       RowBox[{"rank", ",", "\"\<LinkObject\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkFlush", "@", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks_List", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}], "]"}]}], ":=", 
     RowBox[{"LinkFlush", "/@", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks", ",", "\"\<LinkObject\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkReadyQ", "@", 
      RowBox[{"Rank", "[", "rank_Integer", "]"}]}], ":=", 
     RowBox[{"LinkReadyQ", "@", 
      RowBox[{"Rank", "[", 
       RowBox[{"rank", ",", "\"\<LinkObject\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkReadyQ", "@", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks_List", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}], "]"}]}], ":=", 
     RowBox[{"LinkReadyQ", "/@", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks", ",", "\"\<LinkObject\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkRead", "[", 
      RowBox[{
       RowBox[{"Rank", "[", "rank_Integer", "]"}], ",", 
       RowBox[{"h_:", "Identity"}]}], "]"}], ":=", 
     RowBox[{"LinkRead", "[", 
      RowBox[{
       RowBox[{"Rank", "[", 
        RowBox[{"rank", ",", "\"\<LinkObject\>\""}], "]"}], ",", "h"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Rank", "/:", 
     RowBox[{"LinkRead", "[", 
      RowBox[{
       RowBox[{"Rank", "[", 
        RowBox[{"ranks_List", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"#", ",", "IntegerQ"}], "]"}], "&"}], ")"}]}], "]"}], ",", 
       RowBox[{"h_:", "Identity"}]}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"LinkRead", "[", 
        RowBox[{"#", ",", "h"}], "]"}], "&"}], "/@", 
      RowBox[{"Rank", "[", 
       RowBox[{"ranks", ",", "\"\<LinkObject\>\""}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.472413763328125*^9, 3.47241379015625*^9}, 
   3.47241382990625*^9, {3.474580106703125*^9, 3.474580118203125*^9}, {
   3.474580172671875*^9, 3.4745801763125*^9}, {3.474580467015625*^9, 
   3.474580470453125*^9}, {3.4754396907763424`*^9, 3.4754396916200924`*^9}, {
   3.4769300376403413`*^9, 3.4769300407809663`*^9}, {3.477498343703125*^9, 
   3.477498347515625*^9}, {3.477498654265625*^9, 3.477498764890625*^9}, {
   3.477498889671875*^9, 3.47749893521875*^9}, {3.477499102734375*^9, 
   3.47749912296875*^9}, {3.4774992821875*^9, 3.47749929315625*^9}, {
   3.47749948084375*^9, 3.477499485703125*^9}, {3.51328831171875*^9, 
   3.51328832528125*^9}, {3.5132885445*^9, 3.513288577203125*^9}, {
   3.513288791296875*^9, 3.513288792328125*^9}, {3.513288932109375*^9, 
   3.51328893665625*^9}, {3.513289025015625*^9, 3.5132890285*^9}, {
   3.513290340921875*^9, 3.51329035315625*^9}, {3.513290571453125*^9, 
   3.513290581546875*^9}, 3.513290830640625*^9, {3.5132909695625*^9, 
   3.513291015015625*^9}, {3.5132911555*^9, 3.5132911633125*^9}, {
   3.51784008490625*^9, 3.5178401088125*^9}, {3.517840534671875*^9, 
   3.517840604265625*^9}, 3.517840655453125*^9, {3.517840690421875*^9, 
   3.517840747578125*^9}, {3.51784143496875*^9, 3.517841462453125*^9}, {
   3.541819032703125*^9, 3.54181903303125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LinkWrite", "[", 
       RowBox[{
        RowBox[{"Rank", "[", "#", "]"}], ",", 
        RowBox[{"\"\<Message from rank \>\"", "~~", 
         RowBox[{"ToString", "[", "$RankID", "]"}], "~~", "\"\< to rank \>\"",
          "~~", 
         RowBox[{"ToString", "[", "#", "]"}]}]}], "]"}], "&"}], "/@", 
     "$AllRanks"}], ";", "\[IndentingNewLine]", 
    RowBox[{"LinkReadyQ", "@", 
     RowBox[{"Rank", "[", "$AllRanks", "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Rank", "[", "$AllRanks", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.472501369171875*^9, 3.47250146915625*^9}, {
   3.472501807359375*^9, 3.47250187528125*^9}, {3.472502017921875*^9, 
   3.472502101078125*^9}, {3.472502140390625*^9, 3.472502142796875*^9}, {
   3.472502220453125*^9, 3.472502223796875*^9}, {3.472502307234375*^9, 
   3.472502314859375*^9}, {3.47250236840625*^9, 3.472502483453125*^9}, {
   3.472502532296875*^9, 3.472502602703125*^9}, {3.472502805890625*^9, 
   3.472502857671875*^9}, {3.472502940296875*^9, 3.472502988046875*^9}, {
   3.47250302996875*^9, 3.472503057453125*^9}, {3.472505906921875*^9, 
   3.4725059341875*^9}, 3.47250596765625*^9, {3.472505999203125*^9, 
   3.472506003375*^9}, {3.472506117515625*^9, 3.47250612153125*^9}, {
   3.472506298515625*^9, 3.472506305109375*^9}, {3.477500680484375*^9, 
   3.477500686640625*^9}, 3.51328866721875*^9, {3.51328896803125*^9, 
   3.513288972109375*^9}, {3.513289002421875*^9, 3.51328900421875*^9}, {
   3.51328912753125*^9, 3.513289157578125*^9}, {3.51784019678125*^9, 
   3.51784022525*^9}, {3.5178410435*^9, 3.517841048640625*^9}, {
   3.518012086734375*^9, 3.51801212590625*^9}, {3.518012179046875*^9, 
   3.518012210203125*^9}, {3.518012289984375*^9, 3.518012313984375*^9}, {
   3.518012350109375*^9, 3.518012357828125*^9}, {3.51801241940625*^9, 
   3.51801242259375*^9}, 3.518012474734375*^9, {3.518013298375*^9, 
   3.518013308828125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.51801242778125*^9, {3.518012475578125*^9, 3.518012485078125*^9}, 
   3.5180126148125*^9, 3.51801331390625*^9, 3.51801364353125*^9, 
   3.518014341890625*^9, 3.518014395015625*^9, 3.518014589578125*^9, 
   3.51801667965625*^9, {3.5180168008125*^9, 3.518016823609375*^9}, {
   3.5418198766875*^9, 3.541819889578125*^9}, 3.541820062875*^9, 
   3.5418206891875*^9, 3.541820777359375*^9, 3.541820919109375*^9, 
   3.541821064875*^9, {3.54182128746875*^9, 3.54182129828125*^9}, 
   3.54182138684375*^9, 3.541821491859375*^9, 3.54182203453125*^9, 
   3.54182209040625*^9, 3.541822374484375*^9, {3.5418224180625*^9, 
   3.541822447703125*^9}, {3.541822711375*^9, 3.54182272615625*^9}, 
   3.5418228260625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LinkFlush", "@", 
     RowBox[{"Rank", "[", "$AllRanks", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LinkReadyQ", "@", 
     RowBox[{"Rank", "[", "$AllRanks", "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Rank", "[", "$AllRanks", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.51801214271875*^9, 3.518012144859375*^9}, {
   3.518012342625*^9, 3.5180123429375*^9}, 3.5180124780625*^9, {
   3.518013332375*^9, 3.51801333878125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5180121469375*^9, 3.51801218040625*^9, {3.518012212234375*^9, 
   3.5180122255*^9}, {3.51801234415625*^9, 3.518012377796875*^9}, {
   3.5180124208125*^9, 3.518012427796875*^9}, {3.51801247559375*^9, 
   3.51801248509375*^9}, 3.518012614828125*^9, 3.518013313921875*^9, 
   3.518013643546875*^9, 3.51801434190625*^9, 3.51801439503125*^9, 
   3.51801458959375*^9, 3.518016679671875*^9, {3.518016800828125*^9, 
   3.518016823625*^9}, {3.541819876703125*^9, 3.541819889609375*^9}, 
   3.54182006290625*^9, 3.54182068921875*^9, 3.541820777390625*^9, 
   3.541820919125*^9, 3.541821064890625*^9, {3.541821287484375*^9, 
   3.541821298296875*^9}, 3.541821386875*^9, 3.541821491875*^9, 
   3.5418220345625*^9, 3.5418220904375*^9, 3.541822374515625*^9, {
   3.54182241809375*^9, 3.54182244771875*^9}, {3.54182271140625*^9, 
   3.5418227261875*^9}, 3.541822826078125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LinkRead", "@", 
    RowBox[{"Rank", "[", "$AllRanks", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Rank", "[", "$AllRanks", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.518012375875*^9, 3.518012376234375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Message from rank 1 to rank 1\"\>", 
     ",", "\<\"Message from rank 2 to rank 1\"\>", 
     ",", "\<\"Message from rank 3 to rank 1\"\>", 
     ",", "\<\"Message from rank 4 to rank 1\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Message from rank 1 to rank 2\"\>", 
     ",", "\<\"Message from rank 2 to rank 2\"\>", 
     ",", "\<\"Message from rank 3 to rank 2\"\>", 
     ",", "\<\"Message from rank 4 to rank 2\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Message from rank 1 to rank 3\"\>", 
     ",", "\<\"Message from rank 2 to rank 3\"\>", 
     ",", "\<\"Message from rank 3 to rank 3\"\>", 
     ",", "\<\"Message from rank 4 to rank 3\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Message from rank 1 to rank 4\"\>", 
     ",", "\<\"Message from rank 2 to rank 4\"\>", 
     ",", "\<\"Message from rank 3 to rank 4\"\>", 
     ",", "\<\"Message from rank 4 to rank 4\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5180123778125*^9, {3.518012420828125*^9, 3.5180124278125*^9}, {
   3.518012475609375*^9, 3.518012485109375*^9}, 3.51801261484375*^9, 
   3.5180133139375*^9, 3.5180136435625*^9, 3.51801434190625*^9, 
   3.518014395046875*^9, 3.518014589609375*^9, 3.518016679671875*^9, {
   3.51801680084375*^9, 3.518016823640625*^9}, {3.54181987671875*^9, 
   3.541819889625*^9}, 3.541820062921875*^9, 3.541820689234375*^9, 
   3.54182077740625*^9, 3.541820919140625*^9, 3.54182106490625*^9, {
   3.5418212875*^9, 3.541821298328125*^9}, 3.54182138690625*^9, 
   3.54182149190625*^9, 3.541822034578125*^9, 3.541822090453125*^9, 
   3.54182237453125*^9, {3.541822418109375*^9, 3.54182244775*^9}, {
   3.5418227114375*^9, 3.541822726203125*^9}, 3.541822826109375*^9}]
}, Open  ]],

Cell["\<\
Now we demonstrate a slightly more complicated communication pattern: the \
dissemination barrier, which can be used for synchronization between ranks. \
Each rank waits at the barrier for as long as necessary for all ranks to \
catch up; they then exit the barrier simultaneously.\
\>", "Text",
 CellChangeTimes->{{3.4720848284375*^9, 3.47208483696875*^9}, {
   3.47208499046875*^9, 3.47208499696875*^9}, {3.472085037640625*^9, 
   3.472085051046875*^9}, {3.472085194375*^9, 3.472085357546875*^9}, {
   3.47208539065625*^9, 3.472085391859375*^9}, {3.4720854445*^9, 
   3.472085469703125*^9}, {3.47214921490625*^9, 3.472149311734375*^9}, {
   3.472155208140625*^9, 3.47215528353125*^9}, 3.4721579008125*^9, {
   3.472166107609375*^9, 3.472166111921875*^9}, {3.47216629425*^9, 
   3.472166379234375*^9}, {3.472166494859375*^9, 3.472166576015625*^9}, {
   3.472166674359375*^9, 3.47216668846875*^9}, {3.4721667861875*^9, 
   3.472166790640625*^9}, {3.472166822953125*^9, 3.472166886359375*^9}, {
   3.472167081234375*^9, 3.47216708403125*^9}, {3.47216717625*^9, 
   3.47216723790625*^9}, {3.472329747515625*^9, 3.472329747953125*^9}, {
   3.472335755765625*^9, 3.472335756671875*^9}, 3.4723365074375*^9, 
   3.47233655746875*^9, {3.47233689503125*^9, 3.4723369116875*^9}, {
   3.472398766109375*^9, 3.472398814171875*^9}, {3.472398848375*^9, 
   3.47239893609375*^9}, {3.472398983578125*^9, 3.472399042828125*^9}, {
   3.47239908375*^9, 3.4723990985*^9}, 3.472399160625*^9, 3.472405526*^9, {
   3.47240560790625*^9, 3.472405714765625*^9}, {3.4724058379375*^9, 
   3.472405842890625*^9}, {3.472410745109375*^9, 3.472410746046875*^9}, 
   3.47241181590625*^9, {3.472413292171875*^9, 3.47241329475*^9}, {
   3.518014670203125*^9, 3.518014762640625*^9}, {3.5180147999375*^9, 
   3.51801496553125*^9}, {3.518015004484375*^9, 3.518015095921875*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BarrierMessage", ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "implementation", " ", "of", " ", "the", " ", 
       "dissemination", " ", "barrier", " ", "algorithm", " ", "will", " ", 
       "deadlock", " ", "if", " ", "any", " ", "of", " ", "the", " ", "ranks",
        " ", "are", " ", "duplicated", " ", "because", " ", "a", " ", 
       "blocking", " ", "read", " ", "is", " ", "used", " ", "for", " ", 
       RowBox[{"synchronization", ".", " ", "The"}], " ", "ordering", " ", 
       "of", " ", "the", " ", "participating", " ", "ranks", " ", "must", " ",
        "be", " ", "consistent", " ", "between", " ", "calls", " ", "from", 
       " ", "different", " ", "ranks", " ", "for", " ", "the", " ", "same", 
       " ", 
       RowBox[{"reason", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Barrier", "@", 
       RowBox[{"Rank", "[", 
        RowBox[{"ranks_List", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"VectorQ", "[", 
             RowBox[{"#", ",", "IntegerQ"}], "]"}], "&&", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", "$RankID"}], "]"}]}], "&"}], ")"}]}], "]"}]}], 
      ":=", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LinkWrite", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"BarrierMessage", "[", "ranks", "]"}]}], "]"}], ";", 
           RowBox[{"LinkFlush", "[", "#1", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "msg", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Here", " ", "we", " ", "simply", " ", "discard", " ", 
               "irrelevant", " ", 
               RowBox[{"messages", ".", " ", "A"}], " ", "receive", " ", 
               "queue", " ", "would", " ", "be", " ", "an", " ", 
               "improvement", " ", "over", " ", 
               RowBox[{"this", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"msg", "=!=", 
                RowBox[{"BarrierMessage", "[", "ranks", "]"}]}], ",", 
               RowBox[{"msg", "=", 
                RowBox[{"LinkRead", "[", "#2", "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], 
         "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rankCount", "=", 
             RowBox[{"Length", "[", "ranks", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"thisRankPosition", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"ranks", ",", "$RankID"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{"Rank", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "ranks", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}],
               "&"}], "/@", 
             RowBox[{"Mod", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"0", "~", "Range", "~", 
                 RowBox[{"Log", "[", 
                  RowBox[{"2", ",", "rankCount"}], "]"}]}], "//", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"thisRankPosition", "+", 
                    RowBox[{"2", "^", "#"}]}], ",", 
                   RowBox[{"thisRankPosition", "-", 
                    RowBox[{"2", "^", "#"}]}]}], "}"}], "&"}]}], ",", 
               "\[IndentingNewLine]", "rankCount", ",", "1"}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Barrier", "@", 
       RowBox[{"Rank", "[", "_", "]"}]}], "=", "Null"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rank", "[", "$AllRanks", "]"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.474555194671875*^9, 3.4745552503125*^9}, {
   3.4745552891875*^9, 3.474555338515625*^9}, {3.474555373328125*^9, 
   3.474555421515625*^9}, {3.474555534421875*^9, 3.474555664671875*^9}, {
   3.47455570040625*^9, 3.4745557135625*^9}, {3.47455576996875*^9, 
   3.474555778984375*^9}, {3.474555833265625*^9, 3.474555865625*^9}, {
   3.47455591246875*^9, 3.474555915359375*^9}, {3.474556246859375*^9, 
   3.474556259390625*^9}, {3.47455632028125*^9, 3.47455634975*^9}, {
   3.474556400296875*^9, 3.474556429828125*^9}, {3.47455646353125*^9, 
   3.47455647753125*^9}, {3.4745566495625*^9, 3.474556650625*^9}, {
   3.474557202234375*^9, 3.474557247328125*^9}, 3.47455787290625*^9, 
   3.47455873825*^9, {3.47455943471875*^9, 3.47455948946875*^9}, {
   3.47456047678125*^9, 3.474560485453125*^9}, {3.474561037171875*^9, 
   3.47456104265625*^9}, {3.474563118171875*^9, 3.47456314175*^9}, {
   3.474563185609375*^9, 3.47456338996875*^9}, {3.474565130296875*^9, 
   3.474565158609375*^9}, 3.47456521475*^9, {3.474565612171875*^9, 
   3.474565619*^9}, {3.474565750734375*^9, 3.47456577746875*^9}, 
   3.4745658391875*^9, {3.47456592184375*^9, 3.474565927296875*^9}, {
   3.474566044734375*^9, 3.47456604603125*^9}, {3.47456611146875*^9, 
   3.47456615321875*^9}, {3.4745663326875*^9, 3.474566389046875*^9}, 
   3.474566486625*^9, {3.474569533125*^9, 3.474569556125*^9}, {
   3.474570920296875*^9, 3.474570950328125*^9}, 3.4745709845*^9, 
   3.474571019625*^9, {3.474571101609375*^9, 3.474571185484375*^9}, {
   3.474571244703125*^9, 3.47457124884375*^9}, {3.4745717344375*^9, 
   3.474571751390625*^9}, {3.47457180971875*^9, 3.474571815515625*^9}, {
   3.474571893546875*^9, 3.474571894875*^9}, {3.47457209134375*^9, 
   3.474572191390625*^9}, 3.47457238503125*^9, {3.474572672015625*^9, 
   3.4745726935*^9}, {3.47457275228125*^9, 3.47457278425*^9}, {
   3.474572886546875*^9, 3.47457291184375*^9}, {3.474573097265625*^9, 
   3.47457310059375*^9}, {3.4745735645*^9, 3.474573565484375*^9}, {
   3.47457366009375*^9, 3.474573675078125*^9}, {3.4745738549375*^9, 
   3.474573923375*^9}, {3.47457396603125*^9, 3.47457405325*^9}, {
   3.4745780444375*^9, 3.4745782326875*^9}, {3.47457833125*^9, 
   3.47457835571875*^9}, {3.4745784308125*^9, 3.474578461890625*^9}, {
   3.4745785471875*^9, 3.474578577265625*^9}, {3.47457863425*^9, 
   3.4745786818125*^9}, {3.47457872190625*^9, 3.474578742078125*^9}, {
   3.47457878159375*^9, 3.474578787*^9}, {3.474578926390625*^9, 
   3.474578930265625*^9}, {3.47544183890625*^9, 3.47544194921875*^9}, {
   3.475442032015625*^9, 3.4754420828125*^9}, {3.47544212253125*^9, 
   3.475442141875*^9}, {3.47544250165625*^9, 3.4754425279375*^9}, {
   3.475442615828125*^9, 3.475442623375*^9}, {3.475442670625*^9, 
   3.475442721140625*^9}, {3.475442901640625*^9, 3.475442909046875*^9}, {
   3.4769300281559663`*^9, 3.4769300285153413`*^9}, {3.513288597125*^9, 
   3.513288608078125*^9}, {3.513290417125*^9, 3.51329045721875*^9}, {
   3.513291476859375*^9, 3.5132915295*^9}, {3.517604520046875*^9, 
   3.517604522734375*^9}, {3.51778466959375*^9, 3.51778467090625*^9}, 
   3.517840147765625*^9, {3.517841842734375*^9, 3.5178418606875*^9}, {
   3.51801336065625*^9, 3.518013418640625*^9}, {3.51801347365625*^9, 
   3.51801355090625*^9}, {3.518013625046875*^9, 3.51801363984375*^9}, {
   3.518013730703125*^9, 3.518013770578125*^9}, {3.51801381346875*^9, 
   3.518013834578125*^9}, {3.5180138675*^9, 3.51801393725*^9}, {
   3.518014010625*^9, 3.51801412215625*^9}, {3.518014162484375*^9, 
   3.518014218671875*^9}, {3.51801437915625*^9, 3.5180144745*^9}, {
   3.51801462921875*^9, 3.51801463809375*^9}, {3.518014698546875*^9, 
   3.518014698828125*^9}, {3.51801513271875*^9, 3.518015178953125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Through", "@", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Print", ",", "Pause"}], "}"}], "@", 
         RowBox[{"RandomReal", "[", "10", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Barrier", "@", 
        RowBox[{"Rank", "[", "$AllRanks", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rank", "[", "$AllRanks", "]"}]}], "\[IndentingNewLine]", "]"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.467568440140625*^9, 3.467568468640625*^9}, {
   3.467569195375*^9, 3.467569195953125*^9}, {3.467569250640625*^9, 
   3.467569252796875*^9}, {3.46850673259375*^9, 3.4685067350625*^9}, 
   3.468506782484375*^9, {3.468520258484375*^9, 3.46852025984375*^9}, {
   3.468520304890625*^9, 3.468520305875*^9}, {3.46852047984375*^9, 
   3.46852049734375*^9}, {3.468520563078125*^9, 3.46852058215625*^9}, {
   3.46852066603125*^9, 3.46852078321875*^9}, {3.468520872296875*^9, 
   3.468520874328125*^9}, 3.468521003453125*^9, {3.468521093109375*^9, 
   3.46852114703125*^9}, {3.46852118234375*^9, 3.468521190015625*^9}, {
   3.4685212555*^9, 3.46852128140625*^9}, {3.468521646015625*^9, 
   3.46852164796875*^9}, 3.468521999984375*^9, 3.468523003734375*^9, {
   3.468523045765625*^9, 3.46852305428125*^9}, {3.468523985703125*^9, 
   3.468523997234375*^9}, {3.469102341015625*^9, 3.469102345625*^9}, {
   3.46910273265625*^9, 3.4691027436875*^9}, {3.4691029088125*^9, 
   3.4691029239375*^9}, {3.471903327421875*^9, 3.471903337796875*^9}, {
   3.471903385359375*^9, 3.47190338921875*^9}, {3.471993254609375*^9, 
   3.47199325528125*^9}, 3.4721401708125*^9, {3.4722462431762133`*^9, 
   3.4722462468324633`*^9}, {3.4725062551875*^9, 3.472506267609375*^9}, {
   3.4745566724375*^9, 3.474556749984375*^9}, {3.474556811078125*^9, 
   3.474556881640625*^9}, {3.474556918421875*^9, 3.4745569254375*^9}, {
   3.47455697190625*^9, 3.474557011125*^9}, {3.474557068453125*^9, 
   3.4745570809375*^9}, {3.47455714059375*^9, 3.47455715365625*^9}, 
   3.474557555578125*^9, {3.47457926365625*^9, 3.47457927478125*^9}, {
   3.474579342015625*^9, 3.474579344875*^9}, 3.474579379203125*^9, 
   3.47457941103125*^9, {3.4769301663903413`*^9, 3.4769301683278413`*^9}, {
   3.5132904921875*^9, 3.51329049559375*^9}, {3.513291414359375*^9, 
   3.513291421625*^9}, {3.517841055890625*^9, 3.51784108753125*^9}, {
   3.51784159178125*^9, 3.517841606078125*^9}}],

Cell[CellGroupData[{

Cell[BoxData["6.43306565958525`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.541822826140625*^9}],

Cell[BoxData["6.14897746350081`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.541822826140625*^9}],

Cell[BoxData["7.927607389122116`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.541822826171875*^9}],

Cell[BoxData["1.0083795503120392`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5418228261875*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.9375`8.351228731795999", ",", 
   RowBox[{"{", 
    RowBox[{
    "7.9375`8.351228731795999", ",", "7.9375`8.351228731795999", ",", 
     "7.9375`8.351228731795999", ",", "7.9375`8.351228731795999"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.474556685328125*^9, {3.474556868875*^9, 3.4745569000625*^9}, 
   3.474556931890625*^9, {3.474556965875*^9, 3.474556982390625*^9}, 
   3.474557019578125*^9, 3.474557098*^9, 3.47455716803125*^9, 
   3.474557325875*^9, 3.47455738171875*^9, 3.474557562234375*^9, 
   3.47455764665625*^9, {3.474557901296875*^9, 3.47455792509375*^9}, {
   3.474558011265625*^9, 3.47455803740625*^9}, 3.474558147265625*^9, {
   3.47455827590625*^9, 3.474558348578125*^9}, {3.474558382703125*^9, 
   3.474558509734375*^9}, {3.474558547375*^9, 3.474558557359375*^9}, 
   3.47455859365625*^9, 3.474562370203125*^9, 3.474564014265625*^9, 
   3.47456519215625*^9, 3.4745656331875*^9, 3.474565934921875*^9, 
   3.4745663980625*^9, 3.47456668371875*^9, 3.4745708649375*^9, 
   3.474571276171875*^9, 3.4745717158125*^9, 3.474571784625*^9, 
   3.474572208703125*^9, 3.474572326625*^9, 3.47457242090625*^9, 
   3.474573012453125*^9, 3.474573606546875*^9, 3.474573680078125*^9, 
   3.474575166828125*^9, 3.47457923534375*^9, {3.474579269109375*^9, 
   3.4745792796875*^9}, {3.47457935028125*^9, 3.474579417375*^9}, {
   3.474580182859375*^9, 3.4745801935*^9}, {3.4745804759375*^9, 
   3.4745804845*^9}, 3.474580572734375*^9, 3.47458068415625*^9, 
   3.474580795734375*^9, 3.475441640796875*^9, {3.4754418536875*^9, 
   3.475441876078125*^9}, {3.475441933546875*^9, 3.47544196371875*^9}, 
   3.475442042078125*^9, {3.4754421321875*^9, 3.475442159390625*^9}, 
   3.475442555109375*^9, 3.475442627859375*^9, {3.475442663703125*^9, 
   3.47544267646875*^9}, 3.475442793234375*^9, {3.47544361009375*^9, 
   3.475443628796875*^9}, 3.475443679484375*^9, 3.4769301176403413`*^9, 
   3.4769302297497163`*^9, {3.47749781309375*^9, 3.4774978251875*^9}, 
   3.477498511984375*^9, {3.477498982921875*^9, 3.477498992671875*^9}, 
   3.477499599328125*^9, 3.477499643046875*^9, 3.47749967371875*^9, {
   3.477499773609375*^9, 3.4774998244375*^9}, {3.477500696765625*^9, 
   3.4775007099375*^9}, 3.513286693234375*^9, 3.513288207921875*^9, 
   3.51328875425*^9, {3.51328879534375*^9, 3.51328880334375*^9}, 
   3.513288943109375*^9, 3.513288977484375*^9, 3.513289035296875*^9, {
   3.513289140625*^9, 3.51328916215625*^9}, 3.513289929015625*^9, 
   3.513290037234375*^9, {3.513290088359375*^9, 3.513290098296875*^9}, 
   3.513290510296875*^9, {3.5132906404375*^9, 3.513290656375*^9}, 
   3.5132907053125*^9, 3.5132907703125*^9, 3.51329080084375*^9, {
   3.51329103375*^9, 3.51329105053125*^9}, 3.51329110065625*^9, 
   3.51329177090625*^9, 3.517604572046875*^9, {3.517784747453125*^9, 
   3.517784777875*^9}, 3.517840440984375*^9, 3.517841053953125*^9, {
   3.5178410975*^9, 3.51784111946875*^9}, 3.517841406484375*^9, 
   3.517841615984375*^9, {3.51784195928125*^9, 3.517842030875*^9}, {
   3.518011115484375*^9, 3.51801112871875*^9}, 3.5180121148125*^9, 
   3.518012156234375*^9, 3.5180121895625*^9, {3.5180122199375*^9, 
   3.518012234875*^9}, {3.5180123536875*^9, 3.518012386*^9}, {
   3.518012427609375*^9, 3.518012436359375*^9}, {3.518012484875*^9, 
   3.518012490734375*^9}, 3.518012622515625*^9, 3.51801332315625*^9, 
   3.5180136525*^9, 3.518014350609375*^9, 3.518014404078125*^9, 
   3.51801459584375*^9, 3.51801668834375*^9, {3.51801681065625*^9, 
   3.5180168310625*^9}, {3.541819886171875*^9, 3.54181989809375*^9}, 
   3.54182007034375*^9, 3.541820698578125*^9, 3.541820786234375*^9, 
   3.5418209276875*^9, 3.54182107078125*^9, {3.54182129571875*^9, 
   3.541821307484375*^9}, 3.541821396625*^9, 3.5418215018125*^9, 
   3.54182204078125*^9, 3.5418220993125*^9, 3.54182238146875*^9, 
   3.541822424390625*^9, 3.541822457703125*^9, {3.541822720375*^9, 
   3.541822732625*^9}, 3.5418228340625*^9}]
}, Open  ]],

Cell["\<\
Finally, to clean up, we close all of the links and clear the symbols defined \
above.\
\>", "Text",
 CellChangeTimes->{{3.4720848284375*^9, 3.47208483696875*^9}, {
   3.47208499046875*^9, 3.47208499696875*^9}, {3.472085037640625*^9, 
   3.472085051046875*^9}, {3.472085194375*^9, 3.472085357546875*^9}, {
   3.47208539065625*^9, 3.472085391859375*^9}, {3.4720854445*^9, 
   3.472085469703125*^9}, {3.47214921490625*^9, 3.472149311734375*^9}, {
   3.472155208140625*^9, 3.47215528353125*^9}, 3.4721579008125*^9, {
   3.472166107609375*^9, 3.472166111921875*^9}, {3.47216629425*^9, 
   3.472166379234375*^9}, {3.472166494859375*^9, 3.472166576015625*^9}, {
   3.472166674359375*^9, 3.47216668846875*^9}, {3.4721667861875*^9, 
   3.472166790640625*^9}, {3.472166822953125*^9, 3.472166886359375*^9}, {
   3.472167081234375*^9, 3.47216708403125*^9}, {3.47216717625*^9, 
   3.47216723790625*^9}, {3.472329747515625*^9, 3.472329747953125*^9}, {
   3.472335755765625*^9, 3.472335756671875*^9}, 3.4723365074375*^9, 
   3.47233655746875*^9, {3.47233689503125*^9, 3.4723369116875*^9}, {
   3.472398766109375*^9, 3.472398814171875*^9}, {3.472398848375*^9, 
   3.47239893609375*^9}, {3.472398983578125*^9, 3.472399042828125*^9}, {
   3.47239908375*^9, 3.4723990985*^9}, 3.472399160625*^9, 3.472405526*^9, {
   3.47240560790625*^9, 3.472405714765625*^9}, {3.4724058379375*^9, 
   3.472405842890625*^9}, {3.472410745109375*^9, 3.472410746046875*^9}, 
   3.47241181590625*^9, {3.472413292171875*^9, 3.47241329475*^9}, {
   3.518014670203125*^9, 3.518014762640625*^9}, {3.5180147999375*^9, 
   3.51801496553125*^9}, {3.518015004484375*^9, 3.518015095921875*^9}, {
   3.51801527715625*^9, 3.518015325125*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"BarrierMessage", ",", "Barrier"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "[", "Rank", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"LinkClose", "/@", "$RankLinks"}], ";", "\[IndentingNewLine]", 
    RowBox[{"$RankLinks", "=."}], ";", "\[IndentingNewLine]", 
    RowBox[{"$RankCount", "=."}], ";", "\[IndentingNewLine]", 
    RowBox[{"$AllRanks", "=."}], ";", "\[IndentingNewLine]", 
    RowBox[{"$RankID", "=."}], ";"}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "Rank", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$RankCount", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$AllRanks", "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.467052674328125*^9, 3.467052683671875*^9}, {
   3.467053287109375*^9, 3.46705333009375*^9}, {3.46757720353125*^9, 
   3.46757720665625*^9}, {3.467577638984375*^9, 3.467577646921875*^9}, {
   3.468520466328125*^9, 3.468520471484375*^9}, {3.468520880265625*^9, 
   3.468520887625*^9}, {3.47199205390625*^9, 3.47199209015625*^9}, {
   3.47206388875*^9, 3.472063897546875*^9}, {3.472063930171875*^9, 
   3.472064025546875*^9}, {3.472064096984375*^9, 3.472064103390625*^9}, {
   3.472064156875*^9, 3.47206417646875*^9}, 3.472064567640625*^9, {
   3.47206463640625*^9, 3.472064643578125*^9}, {3.472064699421875*^9, 
   3.4720647338125*^9}, {3.472064833578125*^9, 3.472064859328125*^9}, {
   3.4720650745*^9, 3.472065080421875*^9}, {3.472065215296875*^9, 
   3.47206527721875*^9}, {3.47208612215625*^9, 3.47208613665625*^9}, {
   3.4724175488125*^9, 3.472417551234375*^9}, {3.472506098421875*^9, 
   3.47250609878125*^9}, {3.47250640721875*^9, 3.47250640734375*^9}, {
   3.474557998953125*^9, 3.474558003359375*^9}, {3.4774996538125*^9, 
   3.477499668390625*^9}, {3.513288050859375*^9, 3.5132880553125*^9}, {
   3.518014584078125*^9, 3.5180145878125*^9}}]
},
WindowSize->{1016, 750},
WindowMargins->{{Automatic, 88}, {Automatic, 68}},
ShowSelection->True,
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 585, 12, 68, "Text"],
Cell[1133, 34, 9558, 143, 52, "Input"],
Cell[10694, 179, 4573, 71, 71, "Text"],
Cell[15270, 252, 10473, 161, 152, "Input"],
Cell[25746, 415, 1217, 24, 90, "Text"],
Cell[26966, 441, 13240, 229, 272, "Input"],
Cell[40209, 672, 2234, 36, 87, "Text"],
Cell[42446, 710, 9396, 160, 392, "Input"],
Cell[51845, 872, 1806, 28, 50, "Text"],
Cell[53654, 902, 10954, 176, 412, "Input"],
Cell[64611, 1080, 2158, 36, 69, "Text"],
Cell[66772, 1118, 6070, 144, 452, "Input"],
Cell[CellGroupData[{
Cell[72867, 1266, 2059, 37, 112, "Input"],
Cell[74929, 1305, 1152, 23, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76118, 1333, 578, 12, 112, "Input"],
Cell[76699, 1347, 1306, 25, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78042, 1377, 339, 7, 92, "Input"],
Cell[78384, 1386, 1789, 34, 88, "Output"]
}, Open  ]],
Cell[80188, 1423, 1866, 28, 49, "Text"],
Cell[82057, 1453, 8408, 156, 612, "Input"],
Cell[CellGroupData[{
Cell[90490, 1613, 2630, 45, 152, "Input"],
Cell[CellGroupData[{
Cell[93145, 1662, 107, 2, 23, "Print"],
Cell[93255, 1666, 107, 2, 23, "Print"],
Cell[93365, 1670, 108, 2, 23, "Print"],
Cell[93476, 1674, 107, 2, 23, "Print"]
}, Open  ]],
Cell[93598, 1679, 3952, 62, 30, "Output"]
}, Open  ]],
Cell[97565, 1744, 1717, 27, 30, "Text"],
Cell[99285, 1773, 2041, 36, 252, "Input"]
}
]
*)

(* End of internal cache information *)
